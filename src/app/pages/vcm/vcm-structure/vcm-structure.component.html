<div class="h-100">
    <div class="row module-heading title">
        <div>
            <span class="module-back-button" routerLink="/pages/vcm/view-vcm">
                <i aria-hidden="true" class="fas fa-arrow-left"></i>
            </span>
            <span class="module-header-title">Value Chain Mapping</span>
        </div>
        <div class="ml-auto submit">
            <button class="btn btn-primary" (click)="edit()">
                <img src="../../../../assets/images/Projects/edit.svg" class="testplus" />Edit</button>
        </div>
    </div>

    <div class="module-body">
        <div class="vcm-treesmain h-100">
            <!-- <h4 >{{vcmProcess[3].vcmname}}</h4> -->
            <div class="row maincontent">
                <mat-tree [dataSource]="dataSource" #tree [treeControl]="treeControl" class="example-tree">
                    <mat-tree-node *matTreeNodeDef="let node" matTreeNodeToggle >
                        <span class="text-color" *ngIf="node.level == 'L3'" (click)="navigateToNoytation(node)" >{{node.title}}</span>
                        <span *ngIf="node.level == 'L1'">{{node.title}}</span>
                        <span *ngIf="node.level == 'L2'">{{node.title}}<button #pop2="bs-popover" [outsideClick]="true" [popover]="popTemplate" placement="right" *ngIf="node.level=='L2'"  ><mat-icon>add</mat-icon></button></span>

                    </mat-tree-node>
                    <mat-nested-tree-node *matTreeNodeDef="let node; when: hasChild">
                        <div class="mat-tree-node">
                            <button mat-icon-button matTreeNodeToggle [attr.aria-label]="'Toggle ' + node.name">
                                <mat-icon class="mat-icon-rtl-mirror">
                                    {{treeControl.isExpanded(node) ? 'expand_more' : 'chevron_right'}}
                                </mat-icon>
                            </button>
                            {{node.title}}<button #pop2="bs-popover" [popover]="popTemplate" [outsideClick]="true" placement="right" *ngIf="node.level=='L2'" ><mat-icon>add</mat-icon></button>
                        </div>
                        <div [class.example-tree-invisible]="!treeControl.isExpanded(node)" role="group">
                            <ng-container matTreeNodeOutlet></ng-container>
                        </div>
                    </mat-nested-tree-node>
                </mat-tree>
            </div>
        </div>
    </div>
</div>


<ng-template #popTemplate>
    <div class="custom-content ">
        <div class="col-md-12 p-0 form-group Apr-cnt">
            <label class="label-control text-color">Create Notation</label>
            <button type="button" (click)='pop2.hide()' class="notif-close" aria-label="Close">
                <span>
                  <img src="../../../assets/images/RPA/icon_latest/close.svg" />
                </span>
              </button>
        </div>
        <hr>

        <div class="custom-footer-content">
            <p (click)="onCreateBpmn();">Create Bpmn</p>
            <p (click)="onCreateDmn()">Create DMN</p>
        </div>
    </div>
</ng-template>

<process-category-overlay headerTitle="BPMN Details"  [overlay_data]="overlay_data" (proceed)="uploadCreateBpmn($event)" class="bpmnCreate"></process-category-overlay>

<div class="spinoverlay" *ngIf="isLoading">
    <div class="spincenter">
        <img  src='..\assets\images\EZFlow_Loader.gif' class="ezflow-loader"/>
    </div>
</div>