<div class="h-100">
    <div class="row module-heading title">
        <div>
            <span class="module-back-button" routerLink="/pages/vcm/view-vcm">
                <i aria-hidden="true" class="fas fa-arrow-left"></i>
            </span>
            <span class="module-header-title">Value Chain Mapping - Edit</span>
        </div>
        <div class="ml-auto submit">
            <button class="btn btn-primary">Save</button>
        </div>
    </div>

    <div class="module-body">
        <mat-drawer-container class="example-container h-100" style="background-color: white;">
            <mat-drawer #drawer class="example-sidenav vcmprop" mode="side" position="end">
                <div class="close-btn"><img src="../../../../assets/images/VCM/VCM-close.svg" (click)="closeOverlay()" /></div>
                <mat-tab-group>
                    <mat-tab label="Properties">
                        <div class="editcontent">
                            <div class="col-md-12 form-group">
                                <label class="label-control">Process Name</label>
                                <input type="text" disabled class="form-control">
                            </div>
                            <div class="col-md-12 form-group">
                                <label class="label-control">Process Owner</label>
                                <select class="form-control">
                                <option value="" hidden disabled>Select Owner</option>
                                <option *ngFor="let each_approver of processOwners_list;let i=index"
                                    [value]=each_approver.userId>
                                    {{(each_approver.firstName | titlecase) +"
                                    "+(each_approver.lastName==undefined?"":each_approver.lastName)}}</option>
                            </select>
                            </div>
                            <div class="col-md-12 form-group">
                                <label class="label-control">Process Description</label>
                                <textarea class="form-control" placeholder="Enter Process Description"></textarea>
                            </div>
                        </div>
                        <div class="propfooter col-md-12 text-right">
                            <!-- <button class="btn btn-primary" *ngIf="editLevelProperties == 1" (click)="editProperties()">Save</button> -->
                            <!-- <button class="btn btn-primary" *ngIf="editLevelProperties == 2" (click)="editProcessLevel2()">Save</button> -->
                        </div>
                    </mat-tab>
                    <mat-tab label="Documents">
                        <div class="col-md-12 form-group">
                            <!-- <h4 class="procname">{{editProcessName}}</h4> -->
                            <div class="vcmdocs">
                                <img src="../../../../assets/images/VCM/VCM-Upload.svg" />
                                <button class="btn" (click)="fileInput.click()">
                            <input multiple #fileInput type="file" (change)="documentsUpload($event)" style="display:none;" />
                            Upload
                        </button>
                            </div>
                        </div>
                        <div class="col-md-12 form-group files">
                            <p *ngFor="let file of uploadedDocuments;let i = index;">
                                {{file.name}}
                                <span><img src="../../../../assets/images/VCM/VCM-close.svg" class="testplus2 default-img" />
                            <img src="../../../../assets/images/VCM/VCM-close-red.svg" class="testplus2 hover-img"
                                (click)="RemoveFile(file,i)" /></span>
                            </p>
                        </div>
                    </mat-tab>
                </mat-tab-group>
            </mat-drawer>
            <mat-drawer-content>
                <div class="vcm-treesmain h-100">
                    <!-- <h4 >{{vcmProcess[3].vcmname}}</h4> -->
                    <div class="row maincontent">
                        <mat-tree [dataSource]="dataSource" #tree [treeControl]="treeControl" class="example-tree">
                            <mat-tree-node *matTreeNodeDef="let node" matTreeNodeToggle>
                                <span class="text-color" *ngIf="node.level == 'L3'" (click)="navigateToNoytation(node)">{{node.title}}</span>
                                <span *ngIf="node.level == 'L1'">{{node.title}} </span>
                                <span *ngIf="node.level == 'L2'">{{node.title}}
                                <button #pop2="bs-popover" [popover]="popTemplate" [outsideClick]="true" placement="right">
                                    <img src="../../../../assets/images/RPA/icon_latest/new-blue.svg" class="testplus" />
                                </button>
                                <button (click)="addLevel(node)"><img src="../../../../assets/images/VCM/edit-3.svg" class="testplus2"/></button><br>                                
                                <div *ngIf="parent == node.parent && childParent == node.childParent" style="display: flex;width: 150%;margin-top: 5%;">
                                    <input  type="text" class="form-control" placeholder="Enter Process Name" [(ngModel)]="processName">
                                     <button [hidden]="!processName" style="position: relative;right: 8%;" (click)="editLevel3()">
                                        <img  class="testplus1" src="../../../../assets/images/VCM/Green Tick.svg">
                                     </button>
                                </div>
                            </span>
                            </mat-tree-node>
                            <mat-nested-tree-node *matTreeNodeDef="let node; when: hasChild">
                                <div class="mat-tree-node">
                                    <button (click)="viewProperties()" *ngIf="(node.title=='Management Process'&& treeControl.dataNodes[1])|| (node.title=='Core Process'&& treeControl.dataNodes[1]) || (node.title=='Support Process'&& treeControl.dataNodes[2])">
                                    <img src="../../../assets/images/menu-line.svg" class="testplus" alt="">
                                </button>
                                    <button mat-icon-button matTreeNodeToggle [attr.aria-label]="'Toggle ' + node.name" *ngIf="node.title != 'Management Process' && node.title != 'Core Process' && node.title != 'Support Process'">
                                    <mat-icon class="mat-icon-rtl-mirror">
                                        {{treeControl.isExpanded(node) ? 'expand_more' : 'chevron_right'}}
                                    </mat-icon>
                                </button> {{node.title}}
                                    <button style="padding-left: 1%;" #pop2="bs-popover" [popover]="popTemplate" [outsideClick]="true" placement="right" *ngIf="node.title != 'Management Process' && node.title != 'Core Process' && node.title != 'Support Process'">
                                    <img src="../../../../assets/images/RPA/icon_latest/new-blue.svg" class="testplus" />
                                </button>
                                    <button (click)="addLevel(node)" *ngIf="node.level == 'L2' && node.title != 'Management Process' && node.title != 'Core Process' && node.title != 'Support Process'"><img src="../../../../assets/images/VCM/edit-3.svg" class="testplus2"/></button><br>
                                    <div *ngIf="node.level == 'L2' && parent == node.parent && childParent == node.childParent && node.title != 'Management Process' && node.title != 'Core Process' && node.title != 'Support Process'" style="margin-top: 9%;right: 9% !important;position: relative;display: flex; width: 35%;">
                                        <input type="text" class="form-control" placeholder="Enter Process Name" [(ngModel)]="processName" style="width: 75%;">
                                        <button [hidden]="!processName" style="position: relative;right: 8%;" (click)="editLevel3()" style="position: relative;
                                        right: 8%;">
                                            <img  class="testplus1" src="../../../../assets/images/VCM/Green Tick.svg">
                                         </button>
                                    </div>
                                </div>
                                <div [class.example-tree-invisible]="!treeControl.isExpanded(node)" role="group">
                                    <ng-container matTreeNodeOutlet></ng-container>
                                </div>
                            </mat-nested-tree-node>
                        </mat-tree>
                    </div>
                </div>
            </mat-drawer-content>
        </mat-drawer-container>
    </div>
</div>

<process-category-overlay headerTitle="BPMN Details" [overlay_data]="overlay_data" (proceed)="uploadCreateBpmn($event)" class="bpmnCreate"></process-category-overlay>

<ng-template #popTemplate>
    <div class="custom-content ">
        <!-- <div class="col-md-12 p-0 form-group Apr-cnt">
            <h4 class="label-control text-color">Create Notation
                <button type="button" (click)='pop2.hide()' class="notif-close pull-right" aria-label="Close">
                    <span><img src="../../../assets/images/RPA/icon_latest/close.svg" /></span>
                </button>
            </h4>
        </div> -->
        <div class="custom-footer-content">
            <p (click)="onCreateBpmn();"><img src="../../../../assets/images/SO/plus dis.svg" class="testplus" />Create Bpmn</p>
            <p (click)="onCreateDmn()"><img src="../../../../assets/images/SO/plus dis.svg" class="testplus" />Create DMN</p>
            <p (click)="onUploadNotation()"><img src="../../../../assets/images/VCM/VCM-Upload.svg" class="testplus" />Upload Notation</p>
        </div>
    </div>
</ng-template>