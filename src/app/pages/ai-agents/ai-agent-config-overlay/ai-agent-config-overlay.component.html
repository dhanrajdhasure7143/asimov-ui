<div class="h-100 form-main">
  <div class="form-flow predefined-bots">
    <div>
      <div class="form-container col-12" [formGroup]="predefinedBotsForm">
        <div formGroupName="fields" class="row">
          <div *ngFor="let field of disabledFormFields; trackBy: loopTrackBy" class="form-group" [ngClass]="{ 'col-6': field.visibility }" >
            <ng-container *ngIf="field.visibility">
              <div class="">
                <label [for]="field.name" class="col-form-label">
                  <b>{{ field.preAttributeLable }}</b>
                  <span class="required" *ngIf="field.attributeRequired">
                    <b>*</b>
                  </span></label>
                <div class="input-icon-wrapper">
                  <span class="input-icon" *ngIf="field.preAttributeType === 'dropdown'">
                    <img src="../../../../assets/images/agent/portal-dropdown-icon.svg" style="height: 13px; margin-bottom: 5px"  alt=""/>
                  </span>
                  <p-dropdown *ngIf="field.preAttributeType === 'dropdown'" [style]="{ width: '100%', 'border-radius': '8px' }" [formControlName]="field.preAttributeName" [options]="field.options" 
                        [placeholder]="field.placeholder" optionLabel="label" optionValue="value"
                  ></p-dropdown>
                </div>

                <div class="input-icon-wrapper">
                    <span class="input-icon" *ngIf="field.preAttributeLable === 'Automation Agent Name'">
                        <img src="../../../../assets/images/agent/agent-name.svg" style="height: 13px; margin-bottom: 5px" alt="" />
                    </span>
                    <span class="input-icon" *ngIf="field.preAttributeLable === 'Ceipal URL'">
                        <i class="pi pi-globe"></i>
                    </span>
                    <span class="input-icon" *ngIf="field.preAttributeLable === 'UserName'">
                        <i class="pi pi-user"></i>
                    </span>
                    <input pInputText autocomplete="off" [attr.disabled]="field.preAttributeLable === 'Automation Agent Name' && isEdit? true : null" *ngIf="field.preAttributeType == 'text'" [style]="{ width: '50%' }" [type]="field.preAttributeType"
                        class="form-control input-with-icon" [placeholder]="field.placeholder" [id]="field.preAttributeName"
                        [formControlName]="field.preAttributeName" [minlength]="field.minNumber" [maxlength]="field.maxNumber"
                        [pattern]="field.pattern" [required]="field.attributeRequired" />
                </div>

                <div class="input-icon-wrapper">
                    <span class="input-icon" *ngIf="field.preAttributeType === 'password'">
                        <i class="pi pi-lock"></i><i class=""></i>
                    </span>
                    <input pInputText autocomplete="off" *ngIf="field.preAttributeType == 'password'" [style]="{ width: '50%' }"
                        [type]="field.preAttributeType" class="form-control input-with-icon" [placeholder]="field.placeholder"
                        [id]="field.preAttributeName" [formControlName]="field.preAttributeName" [minlength]="field.minNumber"
                        [maxlength]="field.maxNumber" [pattern]="field.pattern" [required]="field.attributeRequired" />
                </div>

                    <div class="input-icon-wrapper">
                        <span class="input-icon-text-area" *ngIf="field.preAttributeType === 'textarea'">
                            <i class="pi pi-align-left"></i><i class=""></i>
                        </span>
                        <textarea *ngIf="field.preAttributeType === 'textarea'" [style]="{width: '70%', 'border-radius': '8px !important'}"
                            class="form-control input-with-icon" [placeholder]="field.placeholder" [id]="field.preAttributeName"
                            [formControlName]="field.preAttributeName" rows="5" [minlength]="field.minNumber" [maxlength]="field.maxNumber"
                            [pattern]="field.pattern" [required]="field.attributeRequired"></textarea>
                    </div>

                <input pInputText *ngIf="field.preAttributeType === 'date'" [style]="{ width: '50%' }" type="date" class="form-control"
                    [placeholder]="field.placeholder" [id]="field.preAttributeName" [formControlName]="field.preAttributeName" />

                <div class="input-icon-wrapper">
                    <span class="input-icon" *ngIf="field.preAttributeType === 'email'">
                        <i class="pi pi-envelope"></i>
                    </span>
                    <input pInputText *ngIf="field.preAttributeType === 'email'" [style]="{ width: '50%' }" type="email"
                        class="form-control input-with-icon" [placeholder]="field.placeholder" [id]="field.preAttributeName"
                        [formControlName]="field.preAttributeName" [minlength]="field.minNumber" [maxlength]="field.maxNumber"
                        [pattern]="field.pattern" [required]="field.attributeRequired" />
                </div>

                <input pInputText *ngIf="field.preAttributeType === 'calendar'" [style]="{ width: '50%' }" type="date"
                    class="form-control" [placeholder]="field.placeholder" [id]="field.preAttributeName"
                    [formControlName]="field.preAttributeName" [minlength]="field.minNumber" [maxlength]="field.maxNumber"
                    [pattern]="field.pattern" [required]="field.attributeRequired" />
                
                <div *ngIf="field.preAttributeType === 'radio'" class="radio-custom-design">
                <div class="form-check radio-custom-box" *ngFor="let option of field.options; trackBy: loopTrackBy">
                    <label class="form-check-label">
                        <input type="radio" class="form-check-input" [id]="field.preAttributeName + '_' + option.value"
                            [value]="option.value" [formControlName]="field.preAttributeName"
                            (change)="onRadioChange(option.value, option)" />
                        {{ option.label }}
                    </label>
                </div>
                </div>

                <div *ngIf="field.preAttributeType === 'checkbox'" class="form-check">
                  <ng-container *ngIf="field.options.length > 0; else noOptions">
                    <div *ngFor="let option of field.options; trackBy: loopTrackBy">
                        <label class="form-check-label">
                            <input type="checkbox" *ngIf="!isEdit" class="form-check-input" [id]="option.value" [value]="option.label"
                                [formControlName]="field.preAttributeName" (change)="onCheckboxChange($event, option, 'onchange')" />
                            <input type="checkbox" *ngIf="isEdit" class="form-check-input" [id]="option.value" [value]="option.label"
                                [formControlName]="option.value" (change)="onCheckboxChange($event, option, 'onchange')" />
                            {{ option.label }}
                        </label>
                    </div>
                    </ng-container>
                    <ng-template #noOptions>
                        <div>
                            <label class="form-check-label">
                                <input type="checkbox" class="form-check-input" [id]="field.preAttributeName"
                                    [formControlName]="field.preAttributeName" />
                                {{ field.placeholder }}
                            </label>
                        </div>
                    </ng-template>
                    </div>
                <div class="custom-file-upload-wrapper" *ngIf="field.preAttributeType === 'file'">
                    <label class="custom-file-upload" [for]="field.preAttributeName">
                        <span class="custom-upload-icon">
                            <i class="pi pi-upload" style="font-size: 20px"></i>
                        </span>
                        <input #fileInput *ngIf="field.preAttributeType === 'file'" type="file" class="custom-hidden-file-input"
                            [id]="field.preAttributeName" disabled [formControlName]="field.preAttributeName" multiple />
                        <span class="custom-file-name"> No file choosen </span>
                    </label>
                </div>

                <ng-container *ngIf="field.preAttributeType === 'file'">
                  <!-- <div class="attachment" *ngFor="let attachment of getAttachements(field.preAttributeName); trackBy: loopTrackBy">
                      <div>
                          <i class="pi pi-file" style="font-size: 0.9rem"></i> &nbsp;
                          <span>{{ attachment.originalFileName }}</span> &nbsp;
                      </div>
                  </div> -->
                </ng-container>

                <div style="width: 100%" *ngIf="field.isValidateRequired">
                    <div>
                        <span class="text-danger" *ngIf="isJobDescrption_error && !isValidateLoader && validate_errorMessage.length > 0">
                            Missing fields in Job description : {{ validate_errorMessage.join(", ") }}</span>
                        <span class="text-success" *ngIf="!isJobDescrption_error && validate_errorMessage.length > 0 && !job_Descrption_error">
                            {{ validate_errorMessage.join(",") }}</span>
                        <span class="text-danger" *ngIf="job_Descrption_error">
                            {{ validate_errorMessage.join(", ") }}</span>
                    </div>
                    <button *ngIf="!isJobDescrptionValid && isValidateLoader" type="button" class="btn bluebg-button"
                        style="float: right">
                        <i class="pi pi-spin pi-spinner" style="font-size: 2rem"></i>
                    </button>
                </div>

                <!-- <div *ngIf="field.preAttributeType != 'checkbox'">
                  <div *ngIf="predefinedBotsForm.get('fields.' + field.preAttributeName).invalid && (predefinedBotsForm.get('fields.' + field.preAttributeName).dirty || predefinedBotsForm.get('fields.' + field.preAttributeName).touched)" 
                      class="text-danger">
                    <div *ngIf="predefinedBotsForm.get('fields.' + field.preAttributeName).errors?.required">
                      {{ field.preAttributeLable }} is required.
                    </div>
                    <div *ngIf="predefinedBotsForm.get('fields.' + field.preAttributeName).errors?.email">
                      {{ field.preAttributeLable }} has an invalid email format.
                    </div>
                    <div *ngIf="predefinedBotsForm.get('fields.' + field.preAttributeName).errors?.minlength">
                      {{ field.preAttributeLable }} must be at least
                      {{ field.minNumber }} characters.
                    </div>
                    <div *ngIf=" predefinedBotsForm.get('fields.' + field.preAttributeName).errors?.maxlength">
                      {{ field.preAttributeLable }} can't be longer than
                      {{ field.maxNumber }} characters.
                    </div>
                    <div *ngIf=" predefinedBotsForm.get('fields.' + field.preAttributeName).errors?.pattern">
                      {{ field.preAttributeLable }} has an invalid format.
                    </div>
                  </div>
                </div> -->
              </div>
            </ng-container>
          </div>
        </div>
        <div>
        <div class="form-group row" *ngIf="predefinedBot_schedulerRequired && !isEdit">
            <!-- <div class="col-md-4 col-form-label">
                      <input class="form-check-input" type="checkbox" id="scheduleBot" formControlName="isScheduleBot" (change)="clearScheduleTime()"/>
                      <label class="form-check-label" for="scheduleBot">
                        <b> Would you like to schedule the bot?</b>
                      </label>
                  </div> -->
            <div class="col-md-4 input-container">
                <input type="text" class="form-control" id="schedule_Time" formControlName="scheduleTime" disabled="true" />
            </div>
        </div>
              <div class="form-group row" *ngIf="predefinedBot_schedulerRequired && isEdit">
                  <!-- <div class="col-md-4 col-form-label">
                              <input class="form-check-input" type="checkbox" id="scheduleBot" formControlName="isScheduleBot" (change)="clearScheduleTime()"/>
                              <label class="form-check-label" for="scheduleBot">
                              <b> Would you like to schedule the bot?</b>
                              </label>
                          </div> -->
                  <div class="col-md-4 input-container">
                      <input type="text" class="form-control" id="schedule_Time" formControlName="scheduleTime" disabled="true" />
                  </div>
              </div>
        </div>
      </div>
    </div>
  </div>
</div>
