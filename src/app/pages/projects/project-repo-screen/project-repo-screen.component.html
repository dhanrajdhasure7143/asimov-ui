<div class="h-100">

  <div class="module-heading title">
    <div>
      <span class="module-back-button" routerLink="/pages/projects/projectdetails" [queryParams]="{id: projectid}" >
        <i aria-hidden="true" class="fas fa-arrow-left"></i>
      </span>
      <span class="module-header-title">
        Project Repo 
      </span>
    </div>
    <div class="ml-auto module-heading-buttons">
      <span class="pull-right">
          <span>
            <button class="btn btn-default" (click)="createUploadRequest(createRequestmodal)" type="button">
              Request File
            </button>
          </span> 
          <span>
            <button class="btn btn-primary" (click)="uploadFile(uploadFilemodal)" type="button">
              <img src="../../../../assets/images/BPMS/upload.svg" class="testplus" />
              Upload File
            </button>
          </span> 
          <span class="projects-menu-item">
            <img src="../../../../assets/images/Projects/Download.svg" class="testplus"  />
          </span>
          <span class="projects-menu-item">
            <img src="../../../../assets/images/Projects/delete-black.svg" class="testplus"  />
          </span>        
          <span class="projects-menu-item">
            <i class="ri-more-2-line"></i>
          </span>
      </span>
    </div>          
  </div>

  <div class="projectrepo-body">

    <div>
      <mat-card id="projects_details_screen" *ngIf="projects_toggle==false">

        <!-- <div class="projects-table-body">
                <table>
                  <tr class="separated">
                    <th>Category</th>
                    <th>File Name</th>
                    <th>Uploaded Date</th>
                    <th>Uploaded by</th>
                    <th>File Size</th>
                    <th>Comments</th>
                    <th>Actions</th>
                  </tr>
                  <tr *ngFor="let element of uploadedFiledata">
                    <td>{{element.category}}</td>
                    <td>{{element.fileName}}</td>
                    <td>{{element.uploadedDate | date:'MMM dd, y, HH:mm:ss'}}</td>
                    <td>{{getUserName(element.uploadedBy)}}</td>
                    <td>{{element.fileSize | fileSizePipe}}</td>
                    <td>{{element.comments}}</td>
                    
                    <td>
                        <span class="projects-menu-item" (click)="onDeleteItem()"><i class="fa fa-trash"></i></span>
                        <span class="projects-menu-item"><i class="fa fa-download"></i></span>
                    </td>
                    </tr>
                 
                </table>
                </div> -->
       <div class="projects-table-body">
          <table mat-table #sort11="matSort" [dataSource]="dataSource3" matSort class="projecttable table" id="autotable">

          <ng-container matColumnDef="category">
            <th mat-header-cell *matHeaderCellDef mat-sort-header>Category</th>
            <td mat-cell   *matCellDef="let element">
              <span *ngIf="element.category!=null" [matTooltip]="element.category">{{element.category}}</span>
              <span *ngIf="element.category==null">---</span>
            </td>
  
        </ng-container>
  
        <ng-container matColumnDef="fileName">
          <th mat-header-cell *matHeaderCellDef mat-sort-header>File Name</th>
          <td mat-cell *matCellDef="let element">
            <span *ngIf="element.fileName!=null" [matTooltip]="element.fileName">{{element.fileName}}</span>
              <span *ngIf="element.fileName==null">---</span>
          </td>
      </ng-container>
        <ng-container matColumnDef="uploadedDate">
            <th mat-header-cell *matHeaderCellDef>Uploaded Date </th>
            <td mat-cell *matCellDef="let element">
                <span *ngIf="element.uploadedDate!=null">{{element.uploadedDate | date:'MMM dd, y, HH:mm:ss'}}</span>
                <span *ngIf="element.uploadedDate==null">---</span>
                <!-- <div class="addresource-btn">
                  <span mat-mini-fab color="primary" matTooltip="Add Resources" (click)="addresource(addresourcemodal)"><i class="fa fa-plus"></i></span>
              </div> -->
            </td>
        </ng-container>
  
        <ng-container matColumnDef="uploadedBy">
          <th mat-header-cell *matHeaderCellDef>Uploaded by  </th>
          <td mat-cell *matCellDef="let element">
            <span *ngIf="element.uploadedBy!=null">{{element.uploadedBy}}</span>
            <span *ngIf="element.uploadedBy==null">---</span>
          </td>
      </ng-container>
       
        <ng-container matColumnDef="fileSize">
          <th mat-header-cell *matHeaderCellDef mat-sort-header>File Size</th>
          <td mat-cell *matCellDef="let element" >
            <span *ngIf="element.fileSize!=null">{{element.fileSize | fileSizePipe}}
              <!-- <mat-progress-bar mode="determinate" [(value)]="element.percentageComplete"></mat-progress-bar> -->
          </span>
          </td>
        </ng-container>
  
  
        <ng-container matColumnDef="comments">
          <th mat-header-cell *matHeaderCellDef mat-sort-header>Comments</th>
          <td mat-cell *matCellDef="let element" >
            <span *ngIf="element.comments!=null">{{element.comments}}</span>
            <span *ngIf="element.comments==null">---</span>
          </td>
        </ng-container>
  
      
  
        <ng-container matColumnDef="action">
          <th mat-header-cell *matHeaderCellDef> Actions</th>
          <td mat-cell *matCellDef="let element" class="action-link tablacs"> 
            <span class="" (click)="onDeleteItem()">
              <img src="../../../../assets/images/Projects/delete-black.svg" class="testplus default-img" />
              <img src="../../../../assets/images/Projects/delete-red.svg" class="testplus hover-img" />
            </span>
            <span class="">
              <img src="../../../../assets/images/Projects/Download.svg" class="testplus">
            </span>
            <!-- <div class="newinntalx">
              <a  (click)="uploadtaskfile(uploadtaskfilemodal,element)" matTooltip="Upload File">
                <i class="fas fa-file-upload"></i>
              </a>|
              <a  (click)="updatetaskdata(updatetaskmodal,element)" matTooltip="Edit Task">
                <img src="../../../../assets/images/Projects/edit.svg">
              </a> |
              <a (click)="deletetask(element)" matTooltip="Delete Task" >
                <img src="../../../../assets/images/Projects/delete-red.svg">
              </a> |
              <a class="clickable text-dark"  *ngIf="element.category =='RPA Implementation'|| element.category =='BPMN Design'"
              (click)="navigateToWorkspace(element)" matTooltip="Model">
                <img src="../../../../../assets/images/Projects/eye-show.svg" />
              </a> 
  
              <a class="disable-bg text-dark" *ngIf="element.category =='Analysis'|| element.category =='Task Mining'" >
                <img src="../../../../../assets/images/Projects/eye-hide.svg" />
              </a>
          </div> -->
          </td>
        </ng-container>
  
          <ng-container matColumnDef="Loading">
            <td mat-footer-cell class="mat-footer" style="text-align:center" *matFooterCellDef colspan="9">
                Loading
            </td>
        </ng-container>
          <ng-container matColumnDef="noData">
              <td mat-footer-cell class="mat-footer" style="text-align:center" *matFooterCellDef colspan="9">
                  No Records Found
              </td>
          </ng-container>
          <tr mat-header-row *matHeaderRowDef="displayedColumns3; sticky: true"></tr>
          <tr class="row-highlight" mat-row *matRowDef="let row; columns: displayedColumns3;"></tr>
          <tr class="row-highlight mat-footer" mat-footer-row *matFooterRowDef="['Loading']" [ngClass]="{'hide':dataSource3!=null}"></tr>
          <tr class="row-highlight mat-footer" mat-footer-row *matFooterRowDef="['noData']" [ngClass]="{'hide':!(dataSource3!=null && dataSource3.data.length==0)}"></tr>
          </table>
          <mat-paginator class="newpaginationdiv" #paginator101 
            [pageSize]="5" [pageSizeOptions]="[5, 10, 25, 50]" [showFirstLastButtons]="true">
          </mat-paginator>
       </div> 
        <div class="">                               
          <span class="module-sub-header-title">
            Pending Requests
          </span>              
        </div>

        <!-- <mat-tab-group mat-align-tabs="Start">
                <mat-tab label="All">
                
              <div class="projects-table-body">
                <table class="table">
                  <thead>
                    <tr class="separated">
                      <th>File Category</th>
                      <th>Request From</th>
                      <th>Request To</th>
                      <th>Description</th>
                      <th>Requested Date</th>
                      <th>Actions</th>
                      
                    </tr>
                  </thead>
                  <tbody>
                    <tr *ngFor="let element of requestedFiledata">
                      <td>{{element.category}}</td>
                      <td>{{getUserName(element.requestFrom)}}</td>
                      <td>{{getUserName(element.requestTo)}}</td>
                      <td>{{element.comments}}</td>
                      <td>{{element.uploadedDate | date:'MMM dd, y, HH:mm:ss'}}</td>
                      
                      <td>
                        
                          <span class="remove-action">
                            <button *ngIf="!((loggedUser != element.requestFrom) && (loggedUser != element.requestTo))" 
                                  (click)="denyFileRequest(denyFileRequestmodal, element)" type="button">
                                  <i class="fas fa-times"></i>
                            </button>
                          </span>
                          <span class="upload-action" *ngIf="loggedUser == element.requestTo">
                            <input type="file" name="file" (change)="uploadRequetedFile($event, element)" id="file" class="inputfile" />
                            <label for="file" (change)="uploadRequetedFile($event, element)">
                              <img src="../../../../assets/images/BPMS/upload.svg" />
                            </label>
                        </span>
                        <span *ngIf="((loggedUser != element.requestFrom) && (loggedUser != element.requestTo))">-</span>
  
                      </td>
                    </tr>
                  </tbody>                    
                </table>
                </div>
         
        </mat-tab>
          <mat-tab label="My Requests">
        <div class="projects-table-body" style="padding:10px;">
            <table>
                  <tr class="separated">
                    <th>File Category</th>
                    <th>Request From</th>
                    <th>Request To</th>
                    <th>Description</th>
                    <th>Requested Date</th>
                    <th>Actions</th>
                    
                  </tr>
                  <tr *ngFor="let element of filterdArray">
                    <td>{{element.category}}</td>
                    <td>{{getUserName(element.requestFrom)}}</td>
                    <td>{{getUserName(element.requestTo)}}</td>
                    <td>{{element.comments}}</td>
                    <td>{{element.uploadedDate | date:'MMM dd, y, HH:mm:ss'}}</td>
                    
                    <td>
                      
                      <td>
                        
                          <span class="remove-action">
                            <button *ngIf="!((loggedUser != element.requestFrom) && (loggedUser != element.requestTo))" 
                                  (click)="denyFileRequest(denyFileRequestmodal, element)" type="button">
                                  <i class="fas fa-times"></i>
                            </button>
                          </span>
                          <span class="upload-action" *ngIf="loggedUser == element.requestTo">
                            <input type="file" name="file" (change)="uploadRequetedFile($event, element)" id="file" class="inputfile" />
                            <label for="file" (change)="uploadRequetedFile($event, element)">
                              <img src="../../../../assets/images/BPMS/upload.svg" />
                            </label>
                        </span>
                        <span *ngIf="((loggedUser != element.requestFrom) && (loggedUser != element.requestTo))">-</span>
  
                      </td>
                    </tr>
                  </tbody>                    
                </table>              
              </div>
            </mat-tab>
          </mat-tab-group>
              
                </div>
              </mat-tab>
            </mat-tab-group> -->

            <mat-tab-group mat-align-tabs="Start">
              <mat-tab label="All">
                
                <div class="projects-table-body">
                  <table mat-table #sort12="matSort" [dataSource]="dataSource4" matSort class="projecttable table" id="autotable">
    
                    <ng-container matColumnDef="category">
                      <th mat-header-cell *matHeaderCellDef mat-sort-header>File Category</th>
                      <td mat-cell   *matCellDef="let element">
                        <span *ngIf="element.category!=null" [matTooltip]="element.category">{{element.category}}</span>
                        <span *ngIf="element.category==null">---</span>
                      </td>
            
                  </ng-container>
            
                  <ng-container matColumnDef="requestFrom">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header>Request From</th>
                    <td mat-cell *matCellDef="let element">
                      <span *ngIf="element.requestFrom!=null" [matTooltip]="element.requestFrom">{{getUserName(element.requestFrom)}}</span>
                        <span *ngIf="element.requestFrom==null">---</span>
                    </td>
                </ng-container>
                <ng-container matColumnDef="requestTo">
                  <th mat-header-cell *matHeaderCellDef mat-sort-header>Request To</th>
                  <td mat-cell *matCellDef="let element">
                    <span *ngIf="element.requestTo!=null" [matTooltip]="element.requestTo">{{getUserName(element.requestTo)}}</span>
                      <span *ngIf="element.requestTo==null">---</span>
                  </td>
              </ng-container>
              <ng-container matColumnDef="comments">
                <th mat-header-cell *matHeaderCellDef>Description</th>
                <td mat-cell *matCellDef="let element">
                  <span *ngIf="element.comments!=null">{{element.comments}}</span>
                  <span *ngIf="element.comments==null">---</span>
                </td>
            </ng-container>
                  <ng-container matColumnDef="uploadedDate">
                      <th mat-header-cell *matHeaderCellDef>Requested Date</th>
                      <td mat-cell *matCellDef="let element">
                          <span *ngIf="element.uploadedDate!=null">{{element.uploadedDate | date:'MMM dd, y, HH:mm:ss'}}</span>
                          <span *ngIf="element.uploadedDate==null">---</span>
                         
                      </td>
                  </ng-container>
            
                
                  <ng-container matColumnDef="action">
                    <th mat-header-cell *matHeaderCellDef> Actions</th>
                    <td mat-cell *matCellDef="let element" class="action-link tablacs"> 
                      <span class="remove-action">
                        <button *ngIf="!((loggedUser != element.requestFrom) && (loggedUser != element.requestTo))" (click)="denyFileRequest(denyFileRequestmodal, element)" type="button"><i class="fas fa-times"></i></button>
                      </span>
                      <span class="upload-action" *ngIf="loggedUser == element.requestTo">
                        <input type="file" name="file" (change)="uploadRequetedFile($event, element)" id="file" class="inputfile" />
                        <label for="file" (change)="uploadRequetedFile($event, element)">
                          <img src="../../../../assets/images/Projects/upload-task.svg" class="testplus" />
                        </label>
                    </span>
                    <span *ngIf="((loggedUser != element.requestFrom) && (loggedUser != element.requestTo))">-</span>
                    
                    </td>
                  </ng-container>
            
                    <ng-container matColumnDef="Loading">
                      <td mat-footer-cell class="mat-footer" style="text-align:center" *matFooterCellDef colspan="9">
                          Loading
                      </td>
                  </ng-container>
                    <ng-container matColumnDef="noData">
                        <td mat-footer-cell class="mat-footer" style="text-align:center" *matFooterCellDef colspan="9">
                            No Records Found
                        </td>
                    </ng-container>
                    <tr mat-header-row *matHeaderRowDef="displayedColumns4; sticky: true"></tr>
                    <tr class="row-highlight" mat-row *matRowDef="let row; columns: displayedColumns4;"></tr>
                    <tr class="row-highlight mat-footer" mat-footer-row *matFooterRowDef="['Loading']" [ngClass]="{'hide':dataSource4!=null}"></tr>
                    <tr class="row-highlight mat-footer" mat-footer-row *matFooterRowDef="['noData']" [ngClass]="{'hide':!(dataSource4!=null && dataSource4.data.length==0)}"></tr>
                  </table>
                  </div>
                
           
          </mat-tab>
          <mat-tab label="My Requests">
            <div class="projects-table-body">
              <table mat-table #sort13="matSort" [dataSource]="dataSource5" matSort class="projecttable table" id="autotable">
    
                <ng-container matColumnDef="category">
                  <th mat-header-cell *matHeaderCellDef mat-sort-header>File Category</th>
                  <td mat-cell   *matCellDef="let element">
                    <span *ngIf="element.category!=null" [matTooltip]="element.category">{{element.category}}</span>
                    <span *ngIf="element.category==null">---</span>
                  </td>
        
              </ng-container>
        
              <ng-container matColumnDef="requestFrom">
                <th mat-header-cell *matHeaderCellDef mat-sort-header>Request From</th>
                <td mat-cell *matCellDef="let element">
                  <span *ngIf="element.requestFrom!=null" [matTooltip]="element.requestFrom">{{getUserName(element.requestFrom)}}</span>
                    <span *ngIf="element.requestFrom==null">---</span>
                </td>
            </ng-container>
            <ng-container matColumnDef="requestTo">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Request To</th>
              <td mat-cell *matCellDef="let element">
                <span *ngIf="element.requestTo!=null" [matTooltip]="element.requestTo">{{getUserName(element.requestTo)}}</span>
                  <span *ngIf="element.requestTo==null">---</span>
              </td>
          </ng-container>
          <ng-container matColumnDef="comments">
            <th mat-header-cell *matHeaderCellDef>Description</th>
            <td mat-cell *matCellDef="let element">
              <span *ngIf="element.comments!=null">{{element.comments}}</span>
              <span *ngIf="element.comments==null">---</span>
            </td>
        </ng-container>
              <ng-container matColumnDef="uploadedDate">
                  <th mat-header-cell *matHeaderCellDef>Requested Date</th>
                  <td mat-cell *matCellDef="let element">
                      <span *ngIf="element.uploadedDate!=null">{{element.uploadedDate | date:'MMM dd, y, HH:mm:ss'}}</span>
                      <span *ngIf="element.uploadedDate==null">---</span>
                     
                  </td>
              </ng-container>
        
            
              <ng-container matColumnDef="action">
                <th mat-header-cell *matHeaderCellDef> Actions</th>
                <td mat-cell *matCellDef="let element" class="action-link tablacs"> 
                  <span class="remove-action">
                    <button *ngIf="!((loggedUser != element.requestFrom) && (loggedUser != element.requestTo))" (click)="denyFileRequest(denyFileRequestmodal, element)" type="button"><i class="fas fa-times"></i></button>
                  </span>
                  <span class="upload-action" *ngIf="loggedUser == element.requestTo">
                    <input type="file" name="file" (change)="uploadRequetedFile($event, element)" id="file" class="inputfile" />
                    <label for="file" (change)="uploadRequetedFile($event, element)">
                      <img src="../../../../assets/images/Projects/upload-task.svg" class="testplus" />
                    </label>
                </span>
                <span *ngIf="((loggedUser != element.requestFrom) && (loggedUser != element.requestTo))">-</span>
                
                </td>
              </ng-container>
        
                <ng-container matColumnDef="Loading">
                  <td mat-footer-cell class="mat-footer" style="text-align:center" *matFooterCellDef colspan="9">
                      Loading
                  </td>
              </ng-container>
                <ng-container matColumnDef="noData">
                    <td mat-footer-cell class="mat-footer" style="text-align:center" *matFooterCellDef colspan="9">
                        No Records Found
                    </td>
                </ng-container>
                <tr mat-header-row *matHeaderRowDef="displayedColumns5; sticky: true"></tr>
                <tr class="row-highlight" mat-row *matRowDef="let row; columns: displayedColumns5;"></tr>
                <tr class="row-highlight mat-footer" mat-footer-row *matFooterRowDef="['Loading']" [ngClass]="{'hide':dataSource5!=null}"></tr>
                <tr class="row-highlight mat-footer" mat-footer-row *matFooterRowDef="['noData']" [ngClass]="{'hide':!(dataSource5!=null && dataSource5.data.length==0)}"></tr>
              </table>
                  
                    </div>
                  </mat-tab>
          </mat-tab-group>        

      </mat-card>
    </div>

    <ng-template class="modal-lr" #createRequestmodal>
      <app-request-file [createRequestmodalref]="createRequestmodalref" [projectid]="projectid" (onrequest)="onrequestFileData($event)"></app-request-file>
    </ng-template>

    <ng-template #denyFileRequestmodal>
      <div class="modal-header modelprhead">
          <h4 class="modal-title pull-left" *ngIf="isDeny">Reason to deny file request</h4>
          <h4 class="modal-title pull-left" *ngIf="!isDeny">Reason to revoke file request</h4>
          <button type="button" class="close pull-right" aria-label="Close" (click)="denyFileRequestmodalref.hide()">
            <span aria-hidden="true"><img alt="" src="../../../../../assets/images/Projects/circle-close.svg"></span>
          </button>
      </div>
      <div class="modal-body modelprbody">
          <div class="container p-0" style="width:100%">
              <form [formGroup]="denyFileRequestForm" (ngSubmit)="saveRequestedfile()">
                  <div class="row">
                      <div class="form-fields col-md-12">
                          <label>Message<span class="star">*</span></label>
                          <textarea class="form-control" rows="3" formControlName="description" placeholder="Enter Message..." >
                          </textarea>
                          <span *ngIf="denyFileRequestForm.get('description').invalid && denyFileRequestForm.get('description').touched"
                                  class="errspan required">Message Required*</span>
                      
                          <h5>This message will be notified to {{getUserName(revokeorDenyValue)}}</h5>
                          
                      </div> 
                  </div>
              </form>
          </div>
      </div>          
      <div class="modal-footer modelprfooter">
          <div class="pull-right">
              <button (click)="denyFileRequestmodalref.hide()" class="btn btn-primary">Cancel</button>
              <button [disabled]="denyFileRequestForm.invalid" (click)="saveRequestedfile()" class="btn btn-primary btn-update">Submit</button>
          </div>
      </div>
    </ng-template>

    <ng-template class="modal-up" #uploadFilemodal>
      <div class="modal-header modelprhead">
          <h4 class="modal-title pull-left">Upload File</h4>
          <button type="button" class="close pull-right" aria-label="Close" (click)="uploadFilemodalref.hide()">
            <span aria-hidden="true"><img alt="" src="../../../../../assets/images/Projects/circle-close.svg"></span>
          </button>
      </div>
      <div class="modal-body modelprbody">
          <div class="container p-0" style="width:100%">
              <form [formGroup]="uploadFileForm" (ngSubmit)="submitUploadFileForm()">
                  <div class="row">
                      <div class="form-fields col-md-12">
                              <label for="fileCategory">File Category<span class="star">*</span></label>
                              <select class="form-control" style="border:1px solid lightgray" formControlName="fileCategory">
                                  <option  [value]="null" disabled hidden>Select Category</option>
                                  <option value="" [selected]="true">Select Category</option>
                                  <option *ngFor="let categories of filecategories" >{{categories.category}}</option>
                                </select>
                                <span *ngIf="uploadFileForm.get('fileCategory').invalid && uploadFileForm.get('fileCategory').touched"
                                    class="errspan required">File Category Required*</span>   
                      </div>
                      <div class="form-fields col-md-12">
                          <label>Upload<span class="star">*</span></label>
                          <input type="file" class="form-control" (change)="chnagefileUploadForm($event)" name="Upload-File"
                           formControlName="uploadFile" placeholder="choose file">
                          <span *ngIf="uploadFileForm.get('uploadFile').invalid && uploadFileForm.get('uploadFile').touched"
                               class="errspan required">File Required*</span>   
                      </div>
                      <div class="col-md-12">
                          <label>Description<span class="star">*</span></label>
                          <textarea class="form-control" formControlName="description" placeholder="Enter Description..." rows="4">
                          </textarea>
                          <span *ngIf="uploadFileForm.get('description').invalid && uploadFileForm.get('description').touched"
                            class="errspan required">Description Required*</span>
                      </div> 
                  </div>
              </form>
          </div>
      </div>          
      <div class="modal-footer modelprfooter">
          <div class="pull-right">
              <button (click)="uploadFilemodalref.hide()" class="btn btn-primary">Cancel</button>
              <button [disabled]="uploadFileForm.invalid" (click)="submitUploadFileForm()" class="btn btn-primary btn-update">Submit</button>
          </div>
      </div>
  </ng-template>


  </div>

</div>
