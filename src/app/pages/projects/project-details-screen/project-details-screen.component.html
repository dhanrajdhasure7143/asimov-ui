<div class="new-prj-details">
  <mat-card id="projects_details_screen" *ngIf="projects_toggle==false">
    <div class="projects-header maincreat">
      <span class="projects-back-button" routerLink="/pages/projects/listOfProjects">
        <i aria-hidden="true" class="fas fa-arrow-left"></i>
      </span>
      <span class="projects-header-title">
        Project Details 
      </span>
      <span class="pull-right" style="font-size:20px;">
        <span class="projects-menu-item" routerLink="/pages/projects/projectreposcreen"><i class="ri-file-line"></i></span>
        <span class="projects-menu-item"><i class="ri-history-line"></i></span>
        <span class="projects-menu-item"><i class="ri-more-2-line"></i></span>
      </span>
    </div>
  
    <div class="projects-table-body">
        <app-project-details-header [users_list]="users_list" [processes]="processes"></app-project-details-header>
    </div>    
  </mat-card>  
  
  <mat-card class="new-prj-tasklist" id="projects_details_screen" *ngIf="projects_toggle==false">
    <div class="row">
      <div class="col-md-4 p-0">
        <span class="projects-header-title">
          Tasks
        </span>
      </div>
      <div class="col-md-8 pr-0">
        <span class="pull-right">
          <span class="projects-menu-item">
            <!-- <button type="button" class="btn btn-default new-attach-btn">Attachments</button> -->
          </span>
          <span class="projects-menu-item">
            <span class="projects-menu-item">
              <button type="button" class="btn btn-primary" (click)="createtask(createtaskmodal)">
                <img src="../../../../assets/images/Projects/White-plus.svg" class="testplus" />Create New
              </button>
            </span>
          </span>
        </span>
      </div>
    </div>
    
    <div class="tasks-body">
      <!-- <img src="..\assets\images\Projects\no_items.svg" height="190px" >
      <figcaption>No items to display!</figcaption> -->
      <table mat-table #sort10="matSort" [dataSource]="dataSource2" matSort class="projecttable table" id="autotable">

        <ng-container matColumnDef="taskCategory">
          <th mat-header-cell *matHeaderCellDef mat-sort-header>Category</th>
          <td mat-cell   *matCellDef="let element">
            <span *ngIf="element.taskCategory!=null" [matTooltip]="element.taskCategory">{{element.taskCategory}}</span>
            <span *ngIf="element.taskCategory==null">---</span>
          </td>

      </ng-container>

      <ng-container matColumnDef="taskName">
        <th mat-header-cell *matHeaderCellDef>Task Name</th>
        <td mat-cell *matCellDef="let element">
          <span *ngIf="element.taskName!=null" [matTooltip]="element.taskName">{{element.taskName}}</span>
            <span *ngIf="element.taskName==null">---</span>
        </td>
    </ng-container>
      <ng-container matColumnDef="resources">
          <th mat-header-cell *matHeaderCellDef>Resource </th>
          <td mat-cell *matCellDef="let element">
              <span *ngIf="element.resources!=null">{{element.resources| userPipe : users_list}}</span>
              <span *ngIf="element.resources==null">---</span>
              <!-- <div class="addresource-btn">
                <span mat-mini-fab color="primary" matTooltip="Add Resources" (click)="addresource(addresourcemodal)"><i class="fa fa-plus"></i></span>
            </div> -->
          </td>
      </ng-container>

      <ng-container matColumnDef="status">
        <th mat-header-cell *matHeaderCellDef>Status  </th>
        <td mat-cell *matCellDef="let element">
          <span *ngIf="element.status!=null">{{element.status}}</span>
          <span *ngIf="element.status==null">---</span>
        </td>
    </ng-container>
     
      <ng-container matColumnDef="percentage">
        <th mat-header-cell *matHeaderCellDef mat-sort-header>Percentage Complete</th>
        <td mat-cell *matCellDef="let element" >
          <ng5-slider [(value)]="element.percentageComplete"  [options]="options" ></ng5-slider>
        </td>
      </ng-container>

      <ng-container matColumnDef="lastModifiedTimestamp">
        <th mat-header-cell *matHeaderCellDef mat-sort-header>Last Updated</th>
        <td mat-cell *matCellDef="let element" >
          <span *ngIf="element.lastModifiedTimestamp!=null">{{element.lastModifiedTimestamp | date}} {{element.lastModifiedTimestamp.split("T")[1].split(".")[0]}}</span>
          <span *ngIf="element.lastModifiedTimestamp==null">---</span>
        </td>
      </ng-container>

      <ng-container matColumnDef="lastModifiedBy">
        <th mat-header-cell *matHeaderCellDef mat-sort-header>Last Updated By</th>
        <td mat-cell *matCellDef="let element" >
          <span *ngIf="element.lastModifiedBy!=null">{{element.lastModifiedBy}}</span>
          <span *ngIf="element.lastModifiedBy==null">---</span>
        </td>
      </ng-container>

      <ng-container matColumnDef="createdBy">
        <th mat-header-cell *matHeaderCellDef mat-sort-header>Created By</th>
        <td mat-cell *matCellDef="let element" >
          <span *ngIf="element.createdBy!=null">{{element.createdBy}}</span>
          <span *ngIf="element.createdBy==null">---</span>
        </td>
      </ng-container>

      <ng-container matColumnDef="action">
        <th mat-header-cell *matHeaderCellDef> Actions</th>
        <td mat-cell *matCellDef="let element" class="action-link tablacs"> 
          <div class="newinntalx">
            <a  (click)="updatetaskdata(updatetaskmodal,element)" matTooltip="Edit Task">
              <img src="../../../../assets/images/Projects/edit.svg">
            </a> |
            <a (click)="deletetask(element)" matTooltip="Delete Task" >
              <img src="../../../../assets/images/Projects/delete-red.svg">
            </a> |
            <a  matTooltip="Model" style="color:red;cursor:pointer">
              <i class="fa fa-tasks" aria-hidden="true"></i>
            </a>   
        </div>
        </td>
      </ng-container>

        <ng-container matColumnDef="Loading">
          <td mat-footer-cell class="mat-footer" style="text-align:center" *matFooterCellDef colspan="9">
              Loading
          </td>
      </ng-container>
        <ng-container matColumnDef="noData">
            <td mat-footer-cell class="mat-footer" style="text-align:center" *matFooterCellDef colspan="9">
                No Records Found
            </td>
        </ng-container>
        <tr mat-header-row *matHeaderRowDef="displayedColumns; sticky: true"></tr>
        <tr class="row-highlight" mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
        <tr class="row-highlight mat-footer" mat-footer-row *matFooterRowDef="['Loading']" [ngClass]="{'hide':dataSource2!=null}"></tr>
        <tr class="row-highlight mat-footer" mat-footer-row *matFooterRowDef="['noData']" [ngClass]="{'hide':!(dataSource2!=null && dataSource2.data.length==0)}"></tr>
      </table>
      </div>
      <mat-paginator #paginator101 [pageSize]="5" [showFirstLastButtons]="true">
      </mat-paginator>
    
  </mat-card>


  <div class="row bortopsec">
    <div class="col-md-6 pl-0 resources">
      <mat-card id="projects_details_screen" class="new-resourcediv" *ngIf="projects_toggle==false">
        <div class="row">
          <div class="col-md-6 p-0">
            <span class="projects-header-title">
              Resources
            </span>
          </div>
          <div class="col-md-6 pr-0">
            <span class="pull-right">
              <span class="projects-menu-item">
                <button type="button" class="btn btn-add"(click)="addresource(addresourcemodal)">
                  <img src="../../../../assets/images/Projects/White-plus.svg" class="testplus"/>Add New
                </button>
              </span>
            </span>
          </div>
        </div>
        <!-- <div class="">
          <span class="">
           
          </span>
          
          <span class="projects-header-title">
            Resources
          </span>
          <span class="pull-right" style="font-size:20px;">
            <span class="projects-menu-item" ></span>
            <span class="projects-menu-item"><button type="button" class="btn btn-primary">Create New</button></span>
          </span>
        </div> -->
        
        <div class="projects-table-body">
          <table class="table">
            <thead>
              <tr class="separated">
                <th></th>
                <th>Name</th>
                <th>Role</th>
                <th>Checkout Item</th>
                <th>Last Updated</th>
              </tr>
            </thead>
            <tbody>
              <tr >
                <!-- <td>
                  <div  class="res-circle " *ngIf="profilePicture==false">{{firstletter|uppercase}}</div> 
                  <div   *ngIf="profilePicture==true"><img class="res-circle " [src]="retrievedImage" ></div>
                </td> -->
                <!-- <td style="text-align:center">{{resourcetablefirstname?resourcetablefirstname:'-' }} {{resourcetablelastname?resourcetablelastname:'-' }}</td> -->
                <td><img src="../../../../assets/images/BPMS/user1.png" /></td>
                <td >Lakshmi Kadali</td>
                <!-- <td style="text-align:center">{{roles?roles:'-'}}</td> -->
                <td >Admin</td>
                <td >01</td>
                <td >09th Jan,2021</td>
              </tr>
              <tr >
                <td><img src="../../../../assets/images/BPMS/user2.png" /></td>
                <td >Srikanth Pothina</td>
                <td >Designer</td>
                <td >06</td>
                <td >20th July,2021</td>
              </tr>
              <tr >
                <td><img src="../../../../assets/images/BPMS/user1.png" /></td>
                <td >Karthik Peddinti</td>
                <td >Process Architect</td>
                <td >05</td>
                <td >15th Mar,2021</td>
              </tr>
            </tbody>
            
          </table>
        </div>
        
      </mat-card>
    </div>
    <div class="col-md-6 p-0 documents">
      <mat-card id="projects_details_screen" class="new-docdiv" *ngIf="projects_toggle==false">
        <div class="row">
          <div class="col-md-6 p-0">
            <span class="projects-header-title">
              Recently Added Documents
            </span>
          </div>
          <div class="col-md-6 pr-0">
            <span class="pull-right">
              <span class="projects-menu-item">
                <button type="button" class="btn btn-primary">Upload New</button>
              </span>
            </span>
          </div>
        </div>
        <!-- <div class="">
          <span class="">
           
          </span>
          
          <span class="projects-header-title">
            Recently Added Documents
          </span>
          <span class="pull-right" style="font-size:20px;">
            <span class="projects-menu-item"  ></span>
            <span class="projects-menu-item"><button type="button" class="btn btn-primary">Upload</button></span>
          </span>
        </div> -->
        
        <div class="projects-table-body">
          <table class="table">
            <thead>
              <tr class="separated">
                <th>Document Name</th>
                <th>Uploaded By</th>
                <th>Uploaded Date</th>
                <th>File Size</th>
              </tr>
            </thead>
            <tbody>
              <tr >
                <td>Task Mining Doc</td>
                <td>Lakshmi Kadali</td>
                <td>Jul 1st,2021</td>
                <td>150kb</td>
              </tr>
              <tr >
                <td>Design Doc</td>
                <td>Karthik Peddinti</td>
                <td>Jul 10th,2021</td>
                <td>125MB</td>
              </tr>
              <tr >
                <td>Approval Email</td>
                <td>Siva Simhadri</td>
                <td>Jul 21st,2021</td>
                <td>10MB</td>
              </tr>
            </tbody>              
          </table>
        </div>
        
      </mat-card>
    </div>   
  </div>



</div>



<ng-template class="modal-lg" #createtaskmodal>
  <app-create-tasks [createtaskmodalref]="createtaskmodalref" [project_id]="project_id"></app-create-tasks>
</ng-template>


<ng-template  #addresourcemodal>
  <div>
    <app-add-resources [addresourcemodalref]="addresourcemodalref"></app-add-resources>
  </div>
  
</ng-template>

<ng-template class="modal-lg" #updatetaskmodal>
  <div class="modal-header modelprhead">
    <h3><b> {{selectedtaskdata.id}} / {{selectedtaskdata.taskCategory}} / {{selectedtaskdata.taskName}}</b></h3>
    <p>Last Updated Date : {{selectedtaskdata.lastModifiedTimestamp | date}}</p>
     <!-- <button type="button" class="close pull-right" aria-label="Close" (click)="updatetaskmodalref.hide()">
      <span aria-hidden="true"><img alt="" src="../../../../../assets/images/Projects/circle-close.svg"></span>
    </button>  -->
  </div>
  <div class="modal-body" style="width:100%;overflow-x: auto;height:calc( 68vh - 10px)">
      <div class="container p-0" style="width:100%">
              <form [formGroup]="updatetaskForm" (ngSubmit)="btn_add()">
              
                  <div class="row">
                      <div class="col-md-12">
                        <div class="form-fileds col-md-3 pl-0">
                          <label for="assignee">Assignee</label>
                          <p>{{selectedtaskdata.resources| userPipe : users_list}}</p>
                        </div>  
                        <div class="form-fileds col-md-3 pr-0">
                          <label for="startDate">Start Date</label>
                          <p>{{selectedtaskdata.startDate | date}}</p>
                        </div>
                        <div class="form-fileds col-md-3 pr-0">
                          <label for="endDate">End Date</label>
                          <p>{{selectedtaskdata.endDate | date}}</p>
                        </div>
                        <div class="form-fileds col-md-3 pr-0">
                          <label for="percentage">Percentage Completed</label>
                        <ng5-slider [(value)]="slider"  [options]="options" ></ng5-slider>
                        </div>
                      </div>
                      <div class="col-md-12">
                        <div class="form-fileds col-md-6 pl-0">                         
                          <label for="status">Status<span style="color:red">*</span></label>
                          <select   formControlName="status"  class="form-control data">
                            <option value="">Select Status</option>
                            <option value="New">New</option>
                            <option value="In Progress">In Progress</option>
                            <option value="In Review">In Review</option>
                            <option value="Approved">Approved</option>
                            <option value="Rejected">Rejected</option>
                        </select>
                        <span *ngIf="updatetaskForm.get('status').invalid && updatetaskForm.get('status').touched" style="color:red" class="fa fa-info-circle errspan">Status Required*</span>
                        </div>
                        <div class="form-fileds col-md-6 pr-0">
                          <label for="priority">Priority <span style="color:red">*</span></label>
                          <select formControlName="priority" class="form-control data">
                              <option value="">Select Priority</option>
                              <option value="High">High</option>
                              <option value="Medium">Medium</option>
                              <option value="Low">Low</option>
                          </select>
                          <span
                              *ngIf="updatetaskForm.get('priority').invalid && updatetaskForm.get('priority').touched"
                              style="color:red" class="fa fa-info-circle errspan">Priority Required*</span>
                        </div>
                       
                      </div>
                      <br> <br>
                      <div class="col-md-12">
                        <label class="label-control" >Summary</label>
                        <textarea class="form-control" formControlName="summary"  style="height:40px;" placeholder="Enter Summary">
                        </textarea>
                        <br>
                      </div>
                     
                      <div class="col-md-12">
                        <label class="label-control" >Description</label>
                                                    <textarea class="form-control" formControlName="description" style="height:70px;" placeholder="Enter Description">
                                                    </textarea>
                      </div>
                      <div class="col-md-12">
                        <label class="label-control" ><h4><b>Activity</b></h4></label>
                      </div>
                      <div class="col-md-12">
                        <mat-tab-group [selectedIndex]="selectedTab" id="Project-dashboard-tabs" (selectedTabChange)="onTabChanged($event)">
                          <mat-tab label="Comment">
                            <br>
                            <div class="t-comments-box">
                              <div class="add-comment">
                                <div  class="res-circle " *ngIf="profilePicture==false">{{firstletter|uppercase}}</div> 
                                <div   *ngIf="profilePicture==true"><img class="res-circle " [src]="retrievedImage" ></div>
                                <div>
                                  &nbsp;
                                </div>
                                <div class="comment-input">
                                  <input
                                    class=" form-control-sm"
                                    type="text" #commentInput id="addcomment"
                                    placeholder="Add a comment.."
                                  />
                                  <div class="comment-send"><i class="fab fa-telegram-plane" id="sendcomment" (click)="postcomments(commentInput.value)"></i></div>
                                </div>
                              </div>
                              <div class="comment comment-level-1" *ngIf="postcomment!=0">
                                <div  class="res-circle " *ngIf="profilePicture==false">{{firstletter|uppercase}}</div> 
                                <div   *ngIf="profilePicture==true"><img class="res-circle " [src]="retrievedImage" ></div>
                                &nbsp;
                                <div>
                                  <div class="comment-label">
                                    <span class="comment-name">
                                      {{firstname}} &nbsp;{{lastname}}&nbsp; {{currentdate | date}}
                                    </span>
                                    <!-- <span class="comment-time"> - 5 days ago</span> -->
                                  </div>
                                  <div class="comment-content" *ngFor="let comments of postcomment;"> 
                                    {{comments}}
                                  </div>
                                  <div class="comment-action">
                                    <!-- <span> <i class="far fa-heart"></i> Like (0)</span>
                                    <span> <i class="far fa-comment-alt"></i> Comment (0)</span> -->
                                  </div>
                                </div>
                              </div>
                            </div>
                            
                          </mat-tab>  
                          <mat-tab label="History">

                          </mat-tab>
                          <mat-tab label="Attachments">

                          </mat-tab>
                          <mat-tab label="Resources">

                          </mat-tab>
                        </mat-tab-group>
                      </div>  
                  </div>
              </form>
      </div>
  </div>          
  <div class="modal-footer modelprfooter">
    <div class="pull-right">
      <button (click)="resetupdatetaskproject()" class="btn btn-primary">Reset</button>
      <button (click)="updatetaskmodalref.hide()" class="btn btn-primary">Cancel</button>
      <button [disabled]="updatetaskForm.invalid" (click)="btn_add()" class="btn btn-primary btn-update">Update</button>
    </div>
  </div>
</ng-template>
