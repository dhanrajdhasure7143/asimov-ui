<div class="maincontent">
    <div class="h-100">
        <div class="row main-content-head">
            <div class="col-md-4 pl-0">
                <h3>
                    <label id="popup_title">
                        <a routerLink="/pages/projects/listOfProjects"><img
                                src="./../../../../assets/images-n/projects/backarrow.svg" alt="back-arrow"></a>
                    </label>
                    <span class="title_text">
                      <span routerLink="/pages/projects/listOfProjects">Projects</span> | <span class="sub_title_text"> {{projectDetails.projectName}}</span>
                    </span>
                </h3>
            </div>
            <div class="col-md-8 pr-0 text-right">
                <button class="btn">
                    <img src="./../../../../assets/images-n/projects/Open.svg" alt="Open">
                    <!-- <span>Open</span> -->
                </button>
                <!-- <button class="btn">
                    <img src="./../../../../assets/images-n/projects/Attribute.svg" alt="Attributes" >
                    <span>Attributes</span>
                </button> -->
                <!-- <button class="btn">
                    <img src="./../../../../assets/images-n/projects/more-vertical.svg" alt="Actions" >
                    <span>Actions</span>
                </button> -->
                <button class="btn" type="button"  (click)="menu.toggle($event)">
                    <img src="./../../../../assets/images-n/projects/more-vertical.svg" alt="Actions" >
                </button>
                <p-menu class="actionspopmenu" #menu [popup]="true" [model]="actionsitems"></p-menu>

                <!-- <span class="text-wh">
                    <button mat-icon-button [matMenuTriggerFor]="menu" class="txt-wh" style="vertical-align: middle;"
                        aria-label="Example icon-button with a menu">
                        <mat-icon class="menu-button">
                        </mat-icon>
                        <img src="./../../../../assets/images-n/projects/more-vertical.svg" alt="Actions">
                    </button>
                </span>
                <mat-menu #menu="matMenu">
                    <button class="ep-pad" (click)='taskListView()'> Tasks</button>
                    <button class="ep-pad" routerLink="/pages/projects/document"> Documents </button>
                    <button class="ep-pad" (click)='openUsersOverlay()'>Users</button>
                </mat-menu> -->
            </div>
        </div>
        <div class="main-content-body">
            <div class="row project-Information">
                <div class="row project-overview">
                    <div class="col-sm-1 p-0">
                        <div class="row project-status">
                            <img *ngIf="projectDetails.status == 'Closed'"
                                src="./../../../../assets/images-n/projects/completed-tasks.svg"
                                alt="project-status-icon">
                            <img *ngIf="projectDetails.status != 'Closed'"
                                src="./../../../../assets/images-n/projects/inprogress-tasks.svg"
                                alt="project-status-icon">
                            <!-- <p>{{projectDetails.status}}</p> -->
                        </div>
                    </div>
                    <div class="col-sm-11 p-0">
                        <div class="row project-ninfo">
                            <div class="row align-items-center">
                                <span class="project-name">{{projectDetails.projectName}}</span>
                                <img src="./../../../../assets/images-n/projects/low_priority.svg" *ngIf="projectDetails.priority == 'Low'" alt="importance">
                                <img src="./../../../../assets/images-n/projects/medium_priority.svg" alt="importance" *ngIf="projectDetails.priority == 'Medium'">
                                <img src="./../../../../assets/images-n/projects/high_priority.svg" alt="importance"  *ngIf="projectDetails.priority == 'High'">
                                <span class="highimp">{{projectDetails.priority}}</span>
                            </div>
                            <div class="row pr-3 align-items-center justify-content-between">
                                <div class="pinf">
                                    <p>{{getUserName(projectDetails.processOwner)}}</p>
                                    <label>Process Owner</label>
                                </div>
                                <div class="pinf">
                                    <p>{{projectDetails.mapValueChain}}</p>
                                    <label>Departments</label>
                                </div>
                                <div class="pinf">
                                    <p>{{getUserName(projectDetails.owner)}}</p>
                                    <label>Created By</label>
                                </div>
                                <div class="pinf">
                                    <p>{{projectDetails.status}}</p>
                                    <label>Status</label>
                                </div>
                                <div class="pinf">
                                    <p>{{projectDetails.lastModifiedTimestamp | date:'MMM dd, y, HH:mm:ss'}}</p>
                                    <label>Last Updated</label>
                                </div>
                                <div class="pinf">
                                    <div class="d-flex">
                                        <span class="kpipercent">
                                            <p>{{projectDetails.projectPercentage}} %</p>
                                            <label>Project Completion</label>
                                        </span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="row project-description">
                    <label>Description</label>
                    <p *ngIf="isReadmoreShow">{{project_desc}} <span class="readmore icon-color" (click)="onReadMoreHide()" >Hide</span></p>
                    <!-- <p>{{projectDetails.projectPurpose}}</p> -->
                    <p *ngIf="!isReadmoreShow">{{truncateDesc(project_desc)}} <span class="readmore icon-color" (click)="onReadMoreHide()" *ngIf="project_desc.length > 150">Read more</span></p>
                </div>
            </div>
            <div class="row">
                <div class="col-md-8 pl-0">
                    <div class="row quicksnapshot">
                        <h4 class="colheads">Quick Snapshot</h4>
                        <div class="row">
                            <div class="col-md-4 pl-0">
                                <div class="row quicksnapshot-cards">
                                    <div class="d-flex w-100 align-items-center">
                                        <div class="qcard-infoimg">
                                            <img src="./../../../../assets/images-n/projects/ActiveTasks.svg"
                                                alt="Active-Tasks" class="qcard-img">
                                        </div>
                                        <div class="qcard-info">
                                            <label class="qcard-count">12</label>
                                            <p class="qcard-name">Active Tasks</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="row quicksnapshot-cards">
                                    <div class="d-flex w-100 align-items-center">
                                        <div class="qcard-infoimg">
                                            <!-- <img src="./../../../../assets/images-n/projects/OverdueTasks.svg" alt="OverdueTasks" class="qcard-img"> -->
                                            <img src="./../../../../assets/images-n/projects/OverdueTasks2.svg"
                                                alt="OverdueTasks" class="qcard-img">
                                        </div>
                                        <div class="qcard-info">
                                            <label class="qcard-count">02</label>
                                            <p class="qcard-name">Delayed Tasks</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-4 pr-0">
                                <div class="row quicksnapshot-cards">
                                    <div class="d-flex w-100 align-items-center">
                                        <div class="qcard-infoimg">
                                            <img src="./../../../../assets/images-n/projects/UsersOnboard.svg"
                                                alt="UserOnboard" class="qcard-img">
                                        </div>
                                        <!--style="margin-left: 8px;" style="margin-left: -9px;" -->
                                        <div class="qcard-info">
                                            <label class="qcard-count">05</label>
                                            <p class="qcard-name">Completed Tasks</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-4 pl-0">
                                <div class="row quicksnapshot-cards ">
                                    <div class="d-flex w-100 align-items-center">
                                        <div class="qcard-infoimg">
                                            <img src="./../../../../assets/images-n/projects/AutomationRate.svg"
                                                alt="AutomationRate" class="qcard-img">
                                        </div>
                                        <div class="qcard-info">
                                            <label class="qcard-count">02</label>
                                            <p class="qcard-name">Users</p>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="col-md-4">
                                <div class="row quicksnapshot-cards ">
                                    <div class="d-flex w-100 align-items-center">
                                        <div class="qcard-infoimg">
                                            <img src="./../../../../assets/images-n/projects/Documents.svg"
                                                alt="Documents" class="qcard-img">
                                        </div>
                                        <div class="qcard-info">
                                            <label class="qcard-count">07</label>
                                            <p class="qcard-name">Documents</p>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="col-md-4 pr-0">
                                <div class="row quicksnapshot-cards ">
                                    <div class="d-flex w-100 align-items-center">
                                        <div class="qcard-infoimg">
                                            <!-- <img src="./../../../../assets/images-n/projects/Frame 2.svg" alt="UnreadMessages" class="qcard-img"> -->
                                            <img src="./../../../../assets/images-n/projects/UnreadMessages.svg"
                                                alt="UnreadMessages" class="qcard-img">
                                        </div>
                                        <div class="qcard-info">
                                            <label class="qcard-count">02</label>
                                            <p class="qcard-name">Pending Approvals</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="row quick-actions">
                        <h6>Quick Actions</h6>
                        <img src="./../../../../assets/images-n/projects/Hand.svg" alt="handicon">
                        <button class="btn blue-btntext" (click)="onCreateTask()">
                            <a><span>Create Task</span></a>
                        </button>
                        <!-- <button class="btn blue-btntext">
                            <a><span> </span></a>
                        </button> -->
                        <button class="btn blue-btntext" (click)="openUsersOverlay()">
                            <a><span>Users</span></a>
                        </button>
                        <button class="btn blue-btntext">
                            <a><span>Create Folder</span></a>
                        </button>
                        <button class="btn blue-btntext">
                            <a><span>Create Documents</span></a>
                        </button>
                        <button class="btn blue-btntext">
                            <a><span>View BPMN</span></a>
                        </button>
                    </div>
                    <div class="row acresources">
                        <h4 class="colheads">Recent Activities</h4>
                        <button class="btn blue-btntext"><a href="#">View All</a></button>
                        <table class="table imgInFirstCol">
                            <thead>
                                <tr>
                                    <th>Activity</th>
                                    <th>Resource</th>
                                    <th>Last Updated</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>Procure work environment</td>
                                    <td><img alt="user-img" src="./../../../../assets/images-n/projects/user1.svg"> Rick
                                    </td>
                                    <td>09th Jan, 12 pm</td>
                                </tr>
                                <tr>
                                    <td>Select necessary work equipment</td>
                                    <td><img alt="user-img" src="./../../../../assets/images-n/projects/user2.svg">
                                        James</td>
                                    <td>09th Jan, 12 pm</td>
                                </tr>
                                <tr>
                                    <td>Setup access rights</td>
                                    <td><img alt="user-img" src="./../../../../assets/images-n/projects/user1.svg">
                                        Johnson</td>
                                    <td>09th Jan, 12 pm</td>
                                </tr>
                                <tr>
                                    <td>Latest task completed</td>
                                    <td><img alt="user-img" src="./../../../../assets/images-n/projects/user2.svg">
                                        William</td>
                                    <td>09th Jan, 12 pm</td>
                                </tr>

                            </tbody>
                        </table>
                    </div>
                </div>
                <div class="col-md-4 pr-0 ">
                    <div class="activecollaboration">
                        <div class="row collab">
                            <h4 class="colheads">Collaborations</h4>
                            <div class="row lftusermsg">
                                <img alt="user-img" src="./../../../../assets/images-n/projects/user2.svg" />
                                <p>Lorem ipsum dolor sit amet, consectetuer adipiscing elit. Lorem ipsum dolor.</p>
                                <p class="userinfo">Rachel M | 09th Jan, 12 pm</p>
                            </div>
                            <div class="row rgtusermsg">
                                <p>Lorem ipsum dolor sit amet, consectetuer adipiscing elit. Lorem ipsum dolor.</p>
                                <p class="rttime">09th Jan, 12 pm</p>
                            </div>
                            <div class="row lftusermsg">
                                <img alt="user-img" src="./../../../../assets/images-n/projects/user1.svg" />
                                <p>Lorem ipsum dolor sit amet, consectetuer adipiscing elit. Lorem ipsum dolor.</p>
                                <!-- <p><a href="#">Lorem ipsum.pdf</a></p> -->
                                <p class="userinfo">Rick Johnson | 09th Jan, 12 pm</p>
                            </div>
                        </div>
                        <div class="row collabottom">
                            <input type="text" class="msgip" placeholder="" [(ngModel)]="typedMessage"
                                value="Lorem ipsum dolor sit amet, consec" />
                            <!-- <button class="btn"><img alt="attachment" src="./../../../../assets/images-n/projects/paperclip.svg" /></button> -->
                            <button class="btn" (click)="sendMessage()"><img alt="send" src="./../../../../assets/images-n/projects/send.svg" /></button>
                        </div>
                    </div>

                </div>
            </div>
        </div>
    </div>
</div>


<!-- own-overlay rpa-modal dynamic-forms-modal -->

<div class="" [hidden]="!hiddenPopUp" style="display: block">
    <app-split-overlay (closeOverlay)="closeOverlay($event)">
        <div class="splitoverlaydiv">
            <p-tabView #tabView (onChange)="onUsersTab($event.index)">
                <p-tabPanel>
                    <ng-template pTemplate="header">
                        <h4>New Users <span *ngIf="checkBoxselected.length >0"> ({{checkBoxselected.length}}
                                        Users selected) </span></h4>
                    </ng-template>
                </p-tabPanel>
                <p-tabPanel>
                    <ng-template pTemplate="header">
                        <h4>Existing Users</h4>
                    </ng-template>
                </p-tabPanel>
            
                <div class="splitoverlaycontent">
                    <p-table #dt1 [value]="users_tableList" [globalFilterFields]="['user_role','fullName']"
                        [columns]="columns_list" [(selection)]="checkBoxselected" [resizableColumns]="true"
                        responsiveLayout="scroll" dataKey="id">
                        <ng-template pTemplate="caption">
                            <div class="d-flex">
                                <p-dropdown *ngIf="users_tabIndex != 1" [options]="roles_list"
                                    class="listdropdown" [(ngModel)]="selectedRole"
                                    (onChange)="onChangeRole($event)" optionLabel="name"></p-dropdown>
                                <span class="p-input-icon-right">
                                    <i class="pi pi-search"></i>
                                    <input type="text" pInputText placeholder="Search" (input)="dt1.filterGlobal($event.target.value, 'contains')">
                                </span>
                                <span *ngIf="users_tabIndex == 1" class="userstabbtns">
                                    <button class="btn">
                                        <img src="./../../../../assets/images-n/projects/Open.svg" alt="Open">
                                        <span>Open</span>
                                    </button>
                                    <button class="btn">
                                        <img src="./../../../../assets/images-n/projects/plus-square_blue.svg"
                                            alt="Create">
                                        <span>Create</span>
                                    </button>
                                </span>
                            </div>
                        </ng-template>
                        <ng-template pTemplate="header" let-columns>
                            <tr *ngIf="users_tabIndex == 1">
                                <th *ngFor="let col of columns">{{col.DisplayName}}
                                </th>
                            </tr>
                        </ng-template>
                        <ng-template pTemplate="body" let-rowData let-columns="columns">
                            <tr>
                                <td *ngIf="users_tabIndex != 1"> <p-tableCheckbox
                                        [value]="rowData"></p-tableCheckbox></td>
                                <td *ngFor="let col of columns">
                                    <span>{{rowData[col.ColumnName]}}</span>
                                    <span *ngIf="col.ColumnName == 'action'">
                                        <div class="newinntalx">
                                            <a (click)="deleteuserById(rowData)">
                                                <img src="../../../../../assets/images/Projects/delete-black.svg"
                                                    alt="" class="default-img">
                                                <img src="../../../../../assets/images/Projects/delete-red.svg"
                                                    alt="" class="hover-img">
                                            </a>
                                        </div>
                                    </span>
                                </td>
                            </tr>
                        </ng-template>
                        <ng-template pTemplate="emptymessage">
                            <tr>
                                <td style="text-align: center;" colspan="7">No Users found</td>
                            </tr>
                        </ng-template>
                    </p-table>
                </div>
                <div class="row justify-content-end" *ngIf="users_tabIndex != 1">
                    <button class="btn blue-btntext">Cancel</button>
                    <button class="btn bluebg-button" (click)="addresources()">Onboard Users</button>
                </div>
            </p-tabView>
            
        </div>
    </app-split-overlay>
</div>

<div [hidden]="!createTaskOverlay">
    <app-split-overlay (closeOverlay)="closeCreateTaskOverlay($event)">
        <div class="">
            <div class="rpa-modal-header">
              <h3>Create Task</h3>
            </div>
            <div class="modal-body actions-mbody actionsoverlay-mbody">
            <div>
              <app-create-tasks [users_list]="users_list" [params_data]="params_data" [hiddenPopUp]="createTaskOverlay"></app-create-tasks>
          </div>
            </div>
        </div>
    </app-split-overlay>
  </div>