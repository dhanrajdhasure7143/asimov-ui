<div class="maincontent">
    <div class="h-100">
        <div class="row main-content-head">
            <div class="col-md-4 pl-0">
                <h3>
                    <label id="popup_title">
                        <a (click)="backToTaskList()"><img src="./../../../../assets/images-n/projects/backarrow.svg"
                                alt="back-arrow"></a>
                    </label>
                    <span class="title_text">
                        Projects | <span>{{project_name}}</span> | <span class="sub_title_text">{{project_name}}</span>
                    </span>
                </h3>
            </div>
            <div class="col-md-8 pr-0 text-right">
                <button class="btn">
                    <img src="./../../../../assets/images-n/projects/Open.svg" alt="Open">&nbsp;Open &nbsp;&nbsp;
                    <!-- <span>Open</span> -->
                </button>
                <button class="btn" (click)="taskAttachments()">
                    <img src="./../../../../assets/images-n/projects/Attach Documents- Icon.svg" alt="Attachments">
                    &nbsp;Attached Documents &nbsp;&nbsp;
                    <!-- <span>Attached Documents</span> -->
                    <!-- <span>Open</span> -->
                </button>
                <!-- <button class="btn">
                    <img src="./../../../../assets/images-n/projects/Attribute.svg" alt="Attributes" >
                    <span>Attributes</span>
                </button> -->
                <!-- <button class="btn">
                    <img src="./../../../../assets/images-n/projects/more-vertical.svg" alt="Actions" >
                    <span>Actions</span>
                </button> -->
            </div>
        </div>
        <div class="main-content-body">
            <div class="row project-Information">
                <div class="row project-overview">
                    <div class="col-1 p-0">
                        <div class="row project-status">
                            <!-- <img *ngIf="projectDetails.status == 'Closed'" src="./../../../../assets/images-n/projects/completed-tasks.svg" alt="project-status-icon" >
                            <img *ngIf="projectDetails.status != 'Closed'" src="./../../../../assets/images-n/projects/inprogress-tasks.svg" alt="project-status-icon" >
                            <p>{{projectDetails.status}}</p> -->
                            <img src="./../../../../assets/images-n/projects/inprogress-tasks.svg"
                                alt="project-status-icon">
                        </div>
                    </div>
                    <div class="col-10 p-0">
                        <div class="row project-ninfo">
                            <div class="row align-items-center">
                                <!-- <span class="project-name">{{projectDetails.projectName}}</span> -->
                                <!-- <img src="./../../../../assets/images-n/projects/Warning.svg" alt="importance"> -->
                                <!-- <span class="highimp">{{projectDetails.priority}}</span> -->
                            </div>
                            <div class="row">
                                <div class="col pl-0 d-flex align-items-center">
                                    <div class="row">
                                        <div class="col-10 p-0 pinf">
                                            <p-inplace #inplace (onActivate)="inplaceActivate('taskName')">
                                                <ng-template pTemplate="display">
                                                    <span class="task-header">{{task_details.taskName}}</span>
                                                </ng-template>
                                                <ng-template pTemplate="content">
                                                    <input type="text" [style]="{'width':'30%'}" pInputText
                                                        [(ngModel)]="taskName" (keydown)="Space($event)"/>
                                                    <span class="pull-right">
                                                        <i class="pi pi-check"
                                                            *ngIf="taskName" (click)="onUpdateDetails('taskName')"></i>
                                                        <i class="pi pi-times" (click)="onDeactivate()"></i>
                                                    </span>
                                                </ng-template>
                                            </p-inplace>
                                            <p-inplace #inplace6 (onActivate)="inplaceActivate('priority')">
                                                <ng-template pTemplate="display">
                                            <span>
                                                <img src="./../../../../assets/images-n/projects/low_priority.svg"
                                                    alt="importance" *ngIf="task_details.priority == 'Low'">
                                                <img src="./../../../../assets/images-n/projects/medium_priority.svg"
                                                    alt="importance" *ngIf="task_details.priority == 'Medium'">
                                                <img src="./../../../../assets/images-n/projects/high_priority.svg"
                                                    alt="importance" *ngIf="task_details.priority == 'High'">
                                                <span class="highimp">{{task_details.priority}}</span>
                                            </span>
                                        </ng-template>
                                        <ng-template pTemplate="content">
                                                <div class="p-field-radiobutton">
                                                    <p-radioButton name="taskPriority" value="Low" [(ngModel)]="priority" ></p-radioButton>
                                                    <label for="low">Low</label>
                                                </div>
                                                <div class="p-field-radiobutton">
                                                    <p-radioButton name="taskPriority" value="Medium" [(ngModel)]="priority"></p-radioButton>
                                                    <label for="inProgress">Medium</label>
                                                </div>
                                                <div class="p-field-radiobutton">
                                                    <p-radioButton name="taskPriority" value="High" [(ngModel)]="priority"></p-radioButton>
                                                    <label for="high">High</label>
                                                </div>
                                            <span class="pull-right">
                                                <i class="pi pi-check"
                                                    (click)="onUpdateDetails('priority')"></i>
                                                <i class="pi pi-times" (click)="onDeactivate()"></i>
                                            </span>
                                        </ng-template>
                                            </p-inplace>
                                        </div>

                                    </div>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-md-2 pinf">
                                    <p>{{task_details.createdBy}}</p>
                                    <label>Assigned By</label>
                                </div>
                                <div class="col-md-2 p-0 pinf">
                                    <p-inplace #inplace1 (onActivate)="inplaceActivate('resources')">
                                        <ng-template pTemplate="display">
                                            <span class="">{{task_details.resources| userPipe : users_list}}</span>
                                        </ng-template>
                                        <ng-template pTemplate="content">
                                            <p-dropdown [options]="users_list" [filter]="true"
                                                [style]="{'width':'100%'}" filterBy="user_email,fullName" required
                                                [autoDisplayFirst]="false" placeholder="Select Assignee"
                                                [(ngModel)]="resources" optionValue="user_email" optionLabel="fullName">
                                            </p-dropdown>
                                            <span>
                                                <i class="pi pi-check" (click)="onUpdateDetails('resources')"></i>
                                                <i class="pi pi-times" (click)="onDeactivate()"></i>
                                            </span>
                                        </ng-template>
                                    </p-inplace>
                                    <label>Resource</label>
                                </div>
                                <div class="col-md-2 p-0 pinf">
                                    <p-inplace #inplace2 (onActivate)="inplaceActivate('status')">
                                        <ng-template pTemplate="display">
                                            <span>{{task_details.status}}</span>
                                        </ng-template>
                                        <ng-template pTemplate="content">
                                            <p-dropdown [options]="status_list" [(ngModel)]="status" required
                                                optionLabel="name" optionValue="name"></p-dropdown>
                                            <span class="pull-right">
                                                <i class="pi pi-check" (click)="onUpdateDetails('status')"></i>
                                                <i class="pi pi-times" (click)="onDeactivate()"></i>
                                            </span>
                                        </ng-template>
                                    </p-inplace>
                                    <label>Status</label>
                                </div>
                                <div class="col-md-2 p-0 pinf">
                                    <!-- <p>{{task_details.endDate | date:'MMM dd, y, HH:mm:ss'}}</p> -->

                                    <p-inplace #inplace4 (onActivate)="inplaceActivate('endDate')">
                                        <ng-template pTemplate="display">
                                            <span>{{task_details.endDate | date:'MMM dd, y, HH:mm:ss'}}</span>
                                        </ng-template>
                                        <ng-template pTemplate="content">
                                            <!-- <p-calendar inputId="basic" [(ngModel)]="due_date"></p-calendar> -->
                                            <input type="date" class="form-control rpa-control" [min]="mindate"
                                                max="9999-12-31" (change)="endDate=$event.target.value"
                                                [value]="endDate" [(ngModel)]="endDate">
                                            <span class="pull-right">
                                                <i class="pi pi-check" (click)="onUpdateDetails('endDate')"></i>
                                                <i class="pi pi-times" (click)="onDeactivate()"></i>
                                            </span>
                                        </ng-template>
                                    </p-inplace>

                                    <!-- <div class="p-fluid grid formgrid">
                                        <div class="field col-12 md:col-4">
                                            <p-calendar inputId="basic" [(ngModel)]="date1"></p-calendar>
                                        </div>
                                    </div> -->
                                    <label>Due Date</label>
                                </div>
                                <div class="col-md-2 p-0 pinf">
                                    <p>{{task_details.lastModifiedTimestamp | date:'MMM dd, y, HH:mm:ss'}}</p>
                                    <label>Last Updated</label>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-1">
                        <span>
                            <p-inplace #inplace5 (onActivate)="inplaceActivate('percentageComplete')">
                                <ng-template pTemplate="display">
                                    <span class="kpibot">{{task_details.percentageComplete}} %</span>
                                </ng-template>
                                <ng-template pTemplate="content">
                                    <input type="text" [style]="{'width':'30%'}" pInputText
                                        [(ngModel)]="percentageComplete" />
                                    <span class="pull-right">
                                        <i class="pi pi-check" (click)="onUpdateDetails('percentageComplete')"></i>
                                        <i class="pi pi-times" (click)="onDeactivate()"></i>
                                    </span>
                                </ng-template>
                            </p-inplace>
                            <label>Task Completion</label>
                        </span>
                    </div>
                </div>
                <!-- <div class="row project-description">
                    <label>Description</label>
                    <p>{{projectDetails.projectPurpose}} <span class="readmore">Read more</span></p>
                </div> -->
            </div>
            <div class="row">
                <div class="col-7">
                    <div>
                        <b>Task Description</b> <br>
                        <p-inplace #inplace3 (onActivate)="inplaceActivateDesc()">
                            <ng-template pTemplate="display">
                                <span [innerHTML]="task_desc"></span>
                                <!-- <div [innerHtml]="task_desc.html"></div> -->

                                <!-- <span>{{descChanges(task_desc)}}</span> -->
                            </ng-template>
                            <ng-template pTemplate="content">
                                <p-editor [(ngModel)]="task_desc" [style]="{'height':'320px'}">
                                    <ng-template pTemplate="header">
                                        <span class="ql-formats">
                                            <button type="button" class="ql-bold" aria-label="Bold"></button>
                                            <button type="button" class="ql-italic" aria-label="Italic"></button>
                                            <button type="button" class="ql-underline" aria-label="Underline"></button>
                                        </span>
                                    </ng-template>
                                </p-editor>
                                <i class="pi pi-check" (click)="onUpdateDesc()"></i>
                                <i class="pi pi-times" (click)="onDeactivate()"></i>
                            </ng-template>
                        </p-inplace>
                        <!-- <span> Lorem ipsum dolor, sit amet consectetur adipisicing elit. Ipsa incidunt tenetur, nam, aspernatur voluptatum tempore eligendi necessitatibus pariatur reiciendis dolore eum! Ea nobis quas vel, quam nam amet adipisci perspiciatis.
                        </span> -->
                        <!-- <textarea [rows]="10" [cols]="103" pInputTextarea>
                            Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.
                        </textarea> -->
                    </div>
                    <!-- <div class="float-right">
                        <button mat-raised-button>Cancel</button> &nbsp;&nbsp;
                        <button mat-raised-button color="primary">Save</button>
                    </div> -->
                </div> &nbsp; &nbsp; &nbsp;&nbsp;&nbsp;&nbsp;
                <div class="col card commentBox">
                    <div>
                        <p-tabView styleClass="task-details-tabs">
                            <p-tabPanel header="Comments">
                                <div class="content">
                                    <div class="" *ngFor=" let item of taskcomments_list">
                                        <div class="row">
                                            <div class="col-2 userimage">
                                                <div class="res-circle">
                                                    {{item.createdUserEmail|userImagePipe:users_list}}
                                                </div>
                                            </div>

                                            <div class="col-10 pl-0 comment-name">
                                                <h5> {{item.createdBy}} </h5>
                                                <div>{{item.createdTimestamp | date :'MMM dd, y, HH:mm:ss'}}</div>
                                                <!-- {{item.createdBy}} {{item.createdTimestamp | date :'MMM dd, y, HH:mm:ss'}} -->
                                                <div class="commentsadded">{{item.comments}} </div>
                                            </div>
                                            <!-- <div class="col-md-2 pr-0 comment-action" *ngIf="i!=commentnumber">
                                                    <button type="button" (click)="editComments(c.comments,i)">
                                                        <img src="../../../../assets/images/Projects/edit-black.svg" class="testplus default-img" />
                                                        <img src="../../../../assets/images/Projects/Edit-blue.svg" class="testplus hover-img" />
                                                    </button>
                                                </div> -->

                                        </div>
                                    </div>
                                </div>
                                <div>
                                    <b>Add Comment</b> <br>
                                    <!-- <textarea [rows]="2" [cols]="58" pInputTextarea [autoResize]="true"></textarea> -->
                                    <!-- <textarea type="text" id="textarea"  class="md-textarea form-control" [(ngModel)]="add_comment"></textarea> -->
                                    <textarea [style]="{'width':'100%'}" [rows]="2" pInputTextarea
                                        [(ngModel)]="add_comment" [autoResize]="true" maxlength="100"></textarea>
                                    <button type="button" class="btn btn-primary btn-sm"
                                        style="float: right; margin-top: 6px;" (click)='postcomments()'>Add</button>
                                </div>
                            </p-tabPanel>
                            <p-tabPanel header="Audit">
                            <div class="historyContent">
                                <ul class="historydiv">
                                    <li *ngFor="let history of taskhistory_list">
                                        <div class="ET-history">
                                            <div class="histcontent">
                                                {{history.message}}{{history.lastModifiedTimestamp | date:'MMM dd, y,
                                                HH:mm:ss'}}
                                            </div>
                                        </div>
                                    </li>
                                </ul>
                            </div>
                                <!-- <div class="text-center" *ngIf="taskhistory_list.length==0">
                                    <h5>No Records Found</h5>
                                </div> -->
                            </p-tabPanel>
                        </p-tabView>
                    </div>
                </div>
            </div>
        </div>
    </div>



    <div [hidden]="!hiddenPopUp">
        <app-split-overlay (closeOverlay)="closeOverlay($event)">
            <div class="bgcolor">
                <div class="rpa-modal-header">
                    <h5> Attached Documnets</h5>
                    <br>
                </div>
                <div class="modal-body actions-mbody actionsoverlay-mbody ">
                    <div class="tablediv">
                        <p-table #dt1 [value]="attached_list" [columns]="columns_list" [(selection)]="checkBoxselected"
                            [resizableColumns]="true" responsiveLayout="scroll" dataKey="id">
                            <ng-template pTemplate="header" let-columns>
                                <tr>
                                    <th style="width: 3rem">
                                        <p-tableHeaderCheckbox></p-tableHeaderCheckbox>
                                    </th>
                                    <th *ngFor="let col of columns">{{col.DisplayName}}
                                    </th>
                                </tr>
                            </ng-template>
                            <ng-template pTemplate="body" let-rowData let-columns="columns">
                                <tr>
                                    <td> <p-tableCheckbox></p-tableCheckbox></td>
                                    <td>
                                        <span></span>
                                        <span>
                                            <div class="newinntalx">
                                                <a (click)="deleteuserById(rowData)">
                                                    <img src="../../../../../assets/images/Projects/delete-black.svg"
                                                        alt="" class="default-img">
                                                    <img src="../../../../../assets/images/Projects/delete-red.svg"
                                                        alt="" class="hover-img">
                                                </a>
                                            </div>
                                        </span>
                                    </td>
                                </tr>
                            </ng-template>
                            <ng-template pTemplate="emptymessage">
                                <tr>
                                    <td style="text-align: center;" colspan="7">No Documents Found</td>
                                </tr>
                            </ng-template>
                        </p-table>
                    </div>
                </div>
            </div>
            <div >
                <div class="" (change)="chnagefileUploadForm($event)">
                    <div class="fileupsec"><input type="file" name="myfile" multiple id=""><img type="file" src="../../../../assets/images-n/projects/Attach.svg" alt=""> &nbsp; <span>Attach Documents</span></div>
                 </div>
            </div>
        </app-split-overlay>
    </div>

    <p-dialog header="Folder Name" [(visible)]="isFile_upload_dialog" [style]="{width: '25vw'}" (onHide)="onCloseFolderOverlay()">
        <span class="p-float-label">
            <p-tree [value]="files" [filter]="false" styleClass="document-tree" selectionMode="single" [style]="{'max-height':'auto','overflow':'auto'}"
            (onNodeUnselect)="nodeUnselect()" [(selection)]="selected_folder"> 
            <!-- <ng-template let-node pTemplate="default">
                <b (click)="onNodeClick($event,node)">{{node.label}}</b>
            </ng-template> -->
        </p-tree>
        <button type="button" class="btn btn-primary">Save</button>
        </span>
    </p-dialog>