
<div class="rpa-content-div mx-3" *ngIf="this.isButtonVisible || enableEnvironment">
    <div class="row environment-search-tools">
        <div class="rpa-env-search environment-search">            
            <input class="form-control toolbar-search" placeholder="Search" *ngIf="!isSearch" (keyup)="applyFilter($event.target.value)">
            <img src="../../../../assets/images/search.svg" matSuffix *ngIf="!isSearch" class="testplus1">
        </div>
        <div class="env-data-tool environment-tools">
            <div *ngIf="!addflag" class="env-btn environment-btntool">
                <button class="tsttooltipbtn"  id="addenvbtn" (click)="create()">
                    <img src='../../../../assets/images/RPA/icon_latest/new-blue.svg'> 
                    <span class="testtooltip">New</span>
                </button>
            </div>
            <div *ngIf="addflag" class="env-btn environment-btntool">
                <button class="deleteenvbtn"  id="addenvbtn" disabled>
                    <img src='../../../../assets/images/RPA/icon_latest/plus dis.svg'> 
                    <span class="testtooltip">New</span>
                </button>
            </div>
            <div *ngIf="deleteflag==true" class="env-btn environment-btntool">
                <button class="tsttooltipbtn"  id="deleteenvbtn" (click)="deleteEnvironments()">
                    <img src='../../../../assets/images/RPA/icon_latest/delete-blue.svg'> 
                    <span class="testtooltip">Delete</span>      
                </button>
            </div>
            <div *ngIf="deleteflag==false" class="env-btn environment-btntool">
                <button  id="deleteenvbtn" title="Delete Environment" disabled>
                    <img src='../../../../assets/images/RPA/icon_latest/delete-dis.svg'> 
                    <span class="testtooltip">Delete</span>
                </button>
            </div>
            <div *ngIf="updateflag==true" class="env-btn environment-btntool">
                <button class="tsttooltipbtn" id="updateenvbtn"  (click)="updatedata()">    
                    <img src='../../../../assets/images/RPA/icon_latest/edit-blue.svg'> 
                    <span class="testtooltip">Modify</span>        
                </button>
            </div>
            <div *ngIf="updateflag==false" class="env-btn environment-btntool">
                <button  id="updateenvbtn"   disabled>       
                    <img src='../../../../assets/images/RPA/icon_latest/edit-dis.svg'>        
                    <span class="testtooltip">Modify</span>      
                </button>
            </div>
            <div *ngIf="deleteflag==true" class="env-btn environment-btntool">
                <button class="tsttooltipbtn"  id="deleteenvbtn" (click)="deploybotenvironment()"> 
                    <img src='../../../../assets/images/RPA/icon_latest/deploy-blue.svg'> 
                    <span class="testtooltip">Deploy</span>
                </button>
            </div>
            <div *ngIf="deleteflag==false" class="env-btn environment-btntool">
                <button id="deployenvbtn" [disabled]="!(deleteflag==true)"  disabled> 
                    <img src='../../../../assets/images/RPA/icon_latest/deploy-dis.svg'> 
                    <span class="testtooltip">Deploy</span>
                </button>
            </div>
    </div>
    </div>
    <div class="col-md-12 con-envr">
        <div class="environment-tablegrid">
            <table mat-table #sort1="matSort" [dataSource]="dataSource1" matSort class="RPA table" id="listofenv">

        <ng-container matColumnDef="check">
            <th mat-header-cell *matHeaderCellDef class="cell1">
                <input [disabled]="checkeddisabled" type="checkbox" id="checkall" [checked]="checkflag" (change)="checkAllCheckBox($event)">
            </th>
            <td mat-cell *matCellDef="let element; let i = index" class="cell1">
                <input type="checkbox" [checked]="element.checked" (change)="checkEnableDisableBtn(element.environmentId, $event)"> 
            </td>
        </ng-container>

        <ng-container matColumnDef="environmentName">
            <th mat-header-cell *matHeaderCellDef mat-sort-header class="cell2">Name</th>
            <td mat-cell *matCellDef="let element" class="cell2"> <span *ngIf="element.environmentName!=null">{{element.environmentName}}</span> <span *ngIf="element.environmentName==''">-</span> </td>
        </ng-container>
        
        <ng-container matColumnDef="environmentType">
            <th mat-header-cell *matHeaderCellDef mat-sort-header class="cell3">Type</th>
            <td mat-cell *matCellDef="let element" class="cell3"> <span *ngIf="element.environmentType!=null">{{element.environmentType}}</span> <span *ngIf="element.environmentType==''">-</span> </td>
        </ng-container>
        <ng-container matColumnDef="agentPath">
            <th mat-header-cell *matHeaderCellDef mat-sort-header class="cell4">Agent Path</th>
            <td mat-cell *matCellDef="let element" class="cell4"> <span *ngIf="element.agentPath!=null">{{element.agentPath}}</span> <span *ngIf="element.agentPath==''">-</span> </td>
        </ng-container>
        <ng-container matColumnDef="categoryName">
            <th mat-header-cell *matHeaderCellDef mat-sort-header class="cell5">Category</th>
            <td mat-cell *matCellDef="let element" class="cell5"> 
                <span *ngIf="element.categoryName!=null">{{element.categoryName}}</span> 
                <span *ngIf="element.environmentName==''">-</span> 
            </td>
        </ng-container>
        <ng-container matColumnDef="hostAddress">
            <th mat-header-cell *matHeaderCellDef class="cell6">IP Address / Host</th>
            <td mat-cell *matCellDef="let element" class="cell6"> 
                <span *ngIf="element.hostAddress!=null">{{element.hostAddress | ipcustompipe}}</span> 
                <span *ngIf="element.hostAddress==''">-</span> </td>
        </ng-container>
        <ng-container matColumnDef="portNumber">
            <th mat-header-cell *matHeaderCellDef mat-sort-header class="cell7">Port</th>
            <td mat-cell *matCellDef="let element" class="cell7"> <span *ngIf="element.portNumber!=null">{{element.portNumber}}</span> <span *ngIf="element.portNumber==''">-</span> </td>
        </ng-container>
        <ng-container matColumnDef="username">
            <th mat-header-cell *matHeaderCellDef mat-sort-header class="cell8">Username</th>
            <td mat-cell *matCellDef="let element" class="cell8"> <span *ngIf="element.username!=null">{{element.username}}</span> <span *ngIf="element.username==''">-</span> </td>
        </ng-container>
        <ng-container matColumnDef="password">
            <th mat-header-cell *matHeaderCellDef  class="cell9">Password / Key</th>
            <td mat-cell *matCellDef="let element" class="cell9"> 
                <span *ngIf="element.password.password !=undefined">
                    <span *ngIf="element.password!=null">*******</span> <span *ngIf="element.password==''">-</span> 
                </span>
                <span *ngIf="element.password.key !=undefined">
                    <a class="clickable downloadLink"  (click)="downloadOption(element.environmentName,element.keyValue)">Download Key</a>
                </span>
            </td>
        </ng-container>
        <ng-container matColumnDef="activeStatus">
            <th mat-header-cell *matHeaderCellDef mat-sort-header class="cell10">Status</th>
            <td mat-cell *matCellDef="let element" class="cell10">
                <span *ngIf="element.activeStatus == 7"><span class='green'>Active</span></span>
                <span *ngIf="element.activeStatus == 8 || element.activeStatus == 0"><span class='red'>Inactive</span></span>
                <!--<span *ngIf="element.activeStatus == 0"><span><img class="rpa-image1" src="/assets/images/RPA/red-circle.png"></span>&nbsp;Undefined</span>-->
            </td>
        </ng-container>

        <ng-container matColumnDef="deployStatus">
            <th mat-header-cell *matHeaderCellDef mat-sort-header class="cell11">Deployed</th>
            <td mat-cell *matCellDef="let element" class="cell11">
                
                <span *ngIf="element.deployStatus == true"><span class='green'>Yes</span></span>
                <span *ngIf="element.deployStatus == false"><span class='red'>No</span></span>
            </td>
        </ng-container>
        <ng-container matColumnDef="createdTimeStamp">
            <th mat-header-cell *matHeaderCellDef mat-sort-header class="cell12">Created Date</th>
            <!-- <td mat-cell *matCellDef="let element"> <span *ngIf="element.createdTimeStamp!=null">{{element.createdTimeStamp | date}} {{element.createdTimeStamp.split("T")[1].split(".")[0]}}</span> <span *ngIf="element.createdTimeStamp==''">-</span> </td> -->
            <td mat-cell *matCellDef="let element" class="cell12"> {{element.createdTimeStamp_converted}}</td>
        </ng-container>
        <ng-container matColumnDef="createdBy">
            <th mat-header-cell *matHeaderCellDef mat-sort-header class="cell13">Created By</th>
            <td mat-cell *matCellDef="let element" class="cell13"> <span *ngIf="element.createdBy!=null">{{element.createdBy}}</span> <span *ngIf="element.createdBy==''">-</span> <span *ngIf="element.createdBy==null">-</span></td>
        </ng-container>

        <tr mat-header-row *matHeaderRowDef="displayedColumns; sticky: true"></tr>
        <tr class="row-highlight" mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
            </table>
            <div>
              </div>
        </div>
        <mat-paginator #paginator1 [pageSize]="10" [pageSizeOptions]="[5, 10, 25, 50]" [showFirstLastButtons]="true" class="newpaginationdiv"></mat-paginator> 
    </div>    
</div>



<div id="createenvironment" class="rpa-modal">
    <div class="rpa-modal-content">
        <div class="rpa-modal-header">
            <span class="rpa-modal-close" (click)="close()"><img src="../../../../assets/images/RPA/icon_latest/close.svg" alt=""></span>
            <h4>Create Environment</h4>
        </div>
        <app-rpa-environment-form  [categoriesList]="categoryList" [isCreate]="isCreate"></app-rpa-environment-form>
    </div>
</div>



<div id="update-popup" class="rpa-modal">
    <div class="rpa-modal-content">
        <div class="rpa-modal-header">
            <span class="rpa-modal-close" (click)="close()"><img src="../../../../assets/images/RPA/icon_latest/close.svg" alt=""></span>
            <h4>Modify Environment</h4>
        </div>
        <app-rpa-environment-form [isCreate]="isCreate" [categoriesList]="categoryList" [updateenvdata]="updateenvdata"></app-rpa-environment-form>
    </div>
</div>
