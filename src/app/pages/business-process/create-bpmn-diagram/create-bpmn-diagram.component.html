<div class="row col-md-12 header_addon">   
</div>
<div class="canvas-container-main">
    <div class='h-100'>
        <span class="err-msg"></span>
        <mat-tab-group class="h-100 canvas-container" headerPosition="below" (selectedTabChange)="displayXML($event)" #notationXMLTab>
            <mat-tab label="Notation">
                <div class="row h-100">
                    <div id="canvas" [class.bps_overlay]="rejectedOrApproved == 'PENDING'" class="col-md-12 h-100 p-0"></div>

                    <div [ngClass]="{propertiesContainerClosed: !propertiesContainer, propertiesContainerOpened: propertiesContainer}" class="propertiesContainer" id="propertiesContainer">
                        <div *ngIf="!menuToggleTitle" [ngClass]="{hideTitle: !menuToggleTitle, showTitle: menuToggleTitle}" class="propertiesTitle" (click)="toggleOpen()">
                            <div class="menuToggle">
                                <img src="../../../../assets/images/BPMS/expand-left.svg" alt="menuToggleIcon" class="menuToggleIcon" >
                            </div>
                        </div>
                        <div *ngIf="menuToggleTitle" [ngClass]="{hideTitle: !menuToggleTitle, showTitle: menuToggleTitle}" class="propertiesTitle" (click)="toggleClosed()">
                            <div class="menuToggle" >
                                <img src="../../../../assets/images/BPMS/expand-right.svg" alt="menuToggleIcon" class="menuToggleIcon" >
                                <label class="menuToggleTitle">Menu</label>
                            </div>
                        </div>

                        <div class="propertiesPanelBody slide-right" id="propertiesPanelBody" [class.slide-left]='isopen'>

                            <mat-accordion>
                                <mat-expansion-panel (opened)="onExpansionClik('1')" hideToggle [expanded]="isOpenedState==1">
                                  <mat-expansion-panel-header>
                                    <mat-panel-title class="accordionHeaderMain">
                                        <div class="accordionHeaderToggle">
                                            <img src="../../../../assets/images/BPMS/Properties.svg" alt="menuToggleIcon" class="menuToggleIcon">
                                            <label class="accordionHeader">Properties</label>
                                            <img src="../../../../assets/images/BPMS/maximize-2.svg" alt="propexpandIcon" class="propexpandIcon">
                                        </div>
                                    </mat-panel-title>
                                  </mat-expansion-panel-header>
                                  <div id="properties" class=""></div>
                                </mat-expansion-panel>

                                <mat-expansion-panel (opened)="onExpansionClik('2')" hideToggle [expanded]="isOpenedState==2">
                                  <mat-expansion-panel-header>
                                    <mat-panel-title>
                                        <div class="accordionHeaderToggle">
                                            <img src="../../../../assets/images/BPMS/Discussions.svg" alt="menuToggleIcon" class="menuToggleIcon">
                                            <label for="" class="accordionHeader">Discussions</label>
                                        </div>                                                
                                    </mat-panel-title>                                            
                                  </mat-expansion-panel-header>
                                  <mat-panel-description>
                                    <div class="activecollaboration">
                                        <div class="row collab">
                                            <div class="row lftusermsg">
                                                <img alt="" src="../../../../assets/images/BPMS/user1.png">
                                                <p>Lorem ipsum dolor sit amet.</p>
                                                <p>Rachel M | 09th Jan, 12 pm</p>
                                            </div>
                                            <div class="row rgtusermsg">
                                                <p>Lorem ipsum dolor sit amet.</p>
                                                <p class="rttime">09th Jan, 12 pm</p>
                                            </div>
                                            <div class="row lftusermsg">
                                                <img alt="" src="../../../../assets/images/BPMS/user2.png">
                                                <p>Lorem ipsum dolor sit amet.</p>
                                                <p><a href="#"><img alt="" src="../../../../assets/images/BPMS/attach-file.svg" width="16px" height="16px">Lorem ipsum.pdf</a></p>
                                                <p>Rick Johnson | 09th Jan, 12 pm</p>
                                            </div>
                                        </div>
                                        <div class="row collabottom">
                                            <textarea  rows="3" class="msgip">Loreum ipsum dolor sit amet, consec</textarea>
                                            <button class="btn"><img alt="" src="../../../../assets/images/BPMS/attach.svg"></button>
                                            <button class="btn"><img alt="" src="../../../../assets/images/BPMS/Send.svg"></button>
                                        </div>
                                    </div>
                                  </mat-panel-description>                                          
                                </mat-expansion-panel>
                                
                                <mat-expansion-panel (opened)="onExpansionClik('3')" hideToggle [expanded]="isOpenedState==3">
                                  <mat-expansion-panel-header>
                                    <mat-panel-title>
                                        <div class="accordionHeaderToggle">
                                            <img src="../../../../assets/images/BPMS/Shortcuts.svg" alt="menuToggleIcon" class="menuToggleIcon">
                                            <label for="" class="accordionHeader">Shortcuts</label>
                                        </div>
                                    </mat-panel-title>                                            
                                  </mat-expansion-panel-header>
                                  <mat-panel-description>
                                    <div class="container">
                                        <div><label for="" class="keyboard_header_shortcuts">Keyboard Shortcuts</label></div>
                                        <table>
                                            <tr *ngFor="let keyboardLabels of keyboardLabels">
                                                <td><span class="keyboard_label_style">{{keyboardLabels.labelName}}</span></td>
                                                <td>
                                                    <div [innerHtml]="keyboardLabels.labelValue" class="keyboard_label_style"></div>
                                                </td>
                                            </tr>
                                        </table>
                                    </div>
                                  </mat-panel-description>                                         
                                </mat-expansion-panel>

                                <mat-expansion-panel (opened)="onExpansionClik('4')" hideToggle [expanded]="isOpenedState==4">
                                  <mat-expansion-panel-header>
                                    <mat-panel-title>
                                        <div class="accordionHeaderToggle">
                                            <img src="../../../../assets/images/BPMS/star.svg" alt="menuToggleIcon" class="menuToggleIcon">
                                            <label for="" class="accordionHeader">Favourites</label>
                                        </div>
                                    </mat-panel-title>                                            
                                  </mat-expansion-panel-header>
                                  <mat-panel-description>
                                    <div class="favouriteslistdiv">
                                        <div class="row">
                                            <img src="../../../../assets/images/BPMS/star-orange.svg" alt="menuToggleIcon" class="menuToggleIcon">
                                            <label for="">Business Process Studio</label>
                                            <label class="favsh">(BPM)</label>
                                        </div>
                                        <div class="row">
                                            <img src="../../../../assets/images/BPMS/star-orange.svg" alt="menuToggleIcon" class="menuToggleIcon">
                                            <label for="">Robotic Process Automation</label>
                                            <label class="favsh">(RPA)</label>
                                        </div>
                                        <div class="row">
                                            <img src="../../../../assets/images/BPMS/star-orange.svg" alt="menuToggleIcon" class="menuToggleIcon">
                                            <label for="">Process Intelligence</label>
                                            <label class="favsh">(PI)</label>
                                        </div>
                                    </div>
                                  </mat-panel-description>
                                </mat-expansion-panel>

                                <mat-expansion-panel (opened)="onExpansionClik('5')" hideToggle [expanded]="isOpenedState==5">
                                  <mat-expansion-panel-header>
                                    <mat-panel-title>
                                        <div class="accordionHeaderToggle">
                                            <img src="../../../../assets/images/BPMS/Activities.svg" alt="menuToggleIcon" class="menuToggleIcon">
                                            <label for="" class="accordionHeader">Activities</label>
                                        </div> 
                                    </mat-panel-title>                                            
                                  </mat-expansion-panel-header>
                                  <mat-panel-description>
                                    <div class="activitieslistdiv">
                                        <p>Activities list Here</p>
                                    </div>
                                  </mat-panel-description>
                                </mat-expansion-panel>

                            </mat-accordion>
                            
                        </div>
                    </div>
                    <div #dmnTabs id="dmn-tabs" *ngIf="selectedNotationType=='dmn'"></div>
                </div>
                <ng-template #wrongXMLcontent>
                    <div class="modal-header">
                        <h4 class="modal-title pull-left xml-error">Error in XML</h4>
                        <button type="button" class="close pull-right" aria-label="Close" (click)="modalRef.hide()">
                            <span aria-hidden="true">&times;</span>
                        </button>
                    </div>
                    <div class="modal-body">
                        {{errXMLcontent}}
                    </div>
                </ng-template>
            </mat-tab>
            <mat-tab label="XML">
                <div class="text-area">
                    <textarea [(ngModel)]="xmlTabContent" rows="22" cols="150">
                        {{xmlTabContent}}
                    </textarea>
                </div>
            </mat-tab>
        </mat-tab-group>
    </div>
    <ngx-spinner bdColor="rgba(51, 51, 51, 0.8)" size="default" type="ball-spin-clockwise">
        <p style="color: white">Auto Saving... </p>
    </ngx-spinner>
</div>


<ng-template #variabletemplate>
    <div class="modal_size">
    <div><h4>Start Process</h4></div>
    <hr>
        <div class="row">
            <div class="col-sm-12 row">
                <form action="" #business='ngForm'>
                <div class="col-sm-4">
                    <h5 for="">Business Key:</h5>
                </div>
                <div class="col-sm-8 business-input">
                    <input type="text" class="form-control" placeholder="Enter Business Key" #business_key id='business_key' name='business_key' [(ngModel)]="businessKey" required>
                    <span *ngIf="((business_key.invalid && business.submitted) || (business_key.errors && business_key.touched) )" 
                    class='fa fa-info-circle errspan'> Business Key required </span>
                </div>
            </form>
            </div>
            
        </div>
        <div class="col-sm-4" >
            <div>
            <p class="variable" (click)='addVariable()'>+ Add Variable</p>
        </div>
        </div>
        <div class="col-sm-12" *ngIf="variables.length>0">
            <div class="col-sm-3">Name</div>
            <div class="col-sm-3">Type</div>
            <div class="col-sm-3">Value</div>
            <div class="col-sm-3"></div>
        </div>
        <form action="" #variableForm="ngForm">
        <section class="col-sm-12 row" *ngFor="let item of variables; let i = index;">
            <div class="col-sm-3">
                <input type="text" class="variable-input form-control" placeholder="Name"  name="variable_name{{i}}" [(ngModel)]='item.variableName' required>
            </div>
            <div class="col-sm-3">
                <select class="variable-input form-control" name="variable_type{{i}}" id="" [(ngModel)]='item.type' required>
                    <option value="" disabled hidden>Select</option>
                    <option value="boolean">Boolean</option>
                    <option value="short">Short</option>
                    <option value="integer">Integer</option>
                    <option value="long">Long</option>
                    <option value="double">Double</option>
                    <option value="string">String</option>
                    <option value="date">Date</option>
                </select>
            </div>
            <div class="col-sm-3">
                <input *ngIf="item.type!='boolean'" type="text" class="variable-input form-control" placeholder="Value" name="variable_value{{i}}" [(ngModel)]='item.value' required>
            <select class="variable-input form-control" *ngIf="item.type=='boolean'" name="variable_value{{i}}" [(ngModel)]='item.value' id="" required>
                <option value="" disabled hidden>Select</option>    
                <option value="true">True</option>
                    <option value="false">False</option>
            </select>
            </div>
            <div class="col-sm-3">
                <button class="btn btn-danger eiap-btn" (click)="removevariable(i)">Remove</button>
            </div>

    </section>
    </form>
    <hr>

    <div class="col-sm-12 row">
        <div class="col-sm-5"></div>
        <div class="col-sm-3">
            <button class="btn btn-secondary cancel_btn eiap-btn" (click)="cancelProcess()">Cancel</button>
        </div>
        <div class="col-sm-1"></div>
        <div class="col-sm-3">
            <button class="btn bluebg-button" [disabled]='business.invalid || variableForm.invalid' (click)="startProcess()">Submit</button>
        </div>
    </div>
    </div>

  </ng-template>




<p-confirmDialog  [style]="{width: '30vw'}" position="center" [baseZIndex]="10000" [closable]="false"></p-confirmDialog>
