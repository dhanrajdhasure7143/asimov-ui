<div class="">
    <p-table #dt1 [value]="table_data" [columns]="selectedColumns" [globalFilterFields]="search_fields"
        [reorderableColumns]="true" [(selection)]="selectedItem" [scrollable]="true"
        [resizableColumns]="true" responsiveLayout="scroll" [selectionMode]="selectionMode" [dataKey]="dataKeyId">
        <ng-template pTemplate="caption">
            <div class="p-d-flex">
                <!-- <p-multiSelect *ngIf="show_column_filter" [options]="columns_list" [(ngModel)]="selectedColumns" optionLabel="DisplayName"
                    selectedItemsLabel="{0} columns selected" [style]="{minWidth: '200px'}"
                    placeholder="Choose Columns">
                    <ng-template let-item pTemplate="item">
                        <div class="country-item" *ngIf="item.DisplayName">
                            <div>{{item.DisplayName}}</div>
                        </div>
                        <div class="country-item" *ngIf="!item.DisplayName">
                            <div>Action</div>
                        </div>
                    </ng-template>
                </p-multiSelect> -->
                <span class="p-input-icon-right gridsearch" *ngIf="show_search_field">
                    <i class="pi pi-search"></i>
                    <input type="text" pInputText placeholder="Search" class="p-inputtext-lg" 
                        (input)="dt1.filterGlobal($event.target.value, 'contains')">
                </span>
                <button *ngIf="show_clear_filter" pButton label="Clear" class="p-button-outlined" icon="pi pi-filter-slash" 
                    (click)="clear(dt1)"></button>
            </div>
        </ng-template>
        <ng-template pTemplate="header" let-columns>
            <tr>
                <th style="flex: 0.09 1 0;" *ngIf="checkBoxShow" class="checkboxth">
                    <p-tableHeaderCheckbox (click)="selectRow()"></p-tableHeaderCheckbox>
                </th>
                <th *ngFor="let col of columns" pReorderableColumn pResizableColumn pSortableColumn="{{col.ColumnName}}"
                    [hidden]="!col.ShowGrid">{{col.DisplayName | removeUnderscore}}
                    <p-columnFilter *ngIf="col.ShowFilter && col.filterWidget == 'multiSelect'" field="representative"
                        matchMode="in" display="menu" [showMatchModes]="false" [showOperator]="false"
                        [showAddButton]="false">
                        <ng-template pTemplate="header">
                            <div class="px-3 pt-3 pb-0">
                                <span class="font-bold">Type</span>
                            </div>
                        </ng-template>
                        <ng-template pTemplate="filter" let-value let-filter="filterCallback">
                            <p-multiSelect [ngModel]="value" [options]="representatives" placeholder="Any"
                                (onChange)="filter($event.value)" optionLabel="name">
                                <ng-template let-option pTemplate="item">
                                    <div class="p-multiselect-representative-option">
                                        <span class="p-ml-1">{{option.name}}</span>
                                    </div>
                                </ng-template>
                            </p-multiSelect>
                        </ng-template>
                    </p-columnFilter>
                    <p-columnFilter  *ngIf="col.ShowFilter && col.filterWidget == 'dropdown'" [field]="col.ColumnName" matchMode="equals" [showMatchModes]="false" [showOperator]="false"
                    [showAddButton]="false" display="menu" [showApplyButton]="false" [showClearButton]="true">
                        <ng-template pTemplate="filter" let-value let-filter="filterCallback">
                            <p-dropdown [ngModel]="value" [options]="col.dropdownList" (onChange)="filter($event.value)" placeholder="Any">
                                <!-- <ng-template let-option pTemplate="item">
                                    <span [class]="'customer-badge status-' + option.value">{{option.categoryName}}</span>
                                </ng-template> -->
                            </p-dropdown>
                        </ng-template>
                    </p-columnFilter>
                    <!-- <p-columnFilter *ngIf="col.ShowFilter && col.filterWidget == 'normal'&& col.filterType == 'text'"
                        type="{{col.filterType}}" field="{{col.ColumnName}}" [showMatchModes]="false" [showOperator]="false"
                        [showAddButton]="false" display="menu" matchMode="contains"></p-columnFilter> -->

                        <p-columnFilter *ngIf="col.ShowFilter && col.filterWidget == 'normal'&& col.filterType == 'text'"
                         field="{{col.ColumnName}}" [showMatchModes]="false" [showOperator]="false"
                        [showAddButton]="false" display="menu" matchMode="contains" [showApplyButton]="false">
                            <ng-template pTemplate="filter" let-value let-filter="filterCallback">
                                <input type="text"
                                  pInputText
                                  [ngModel]="value"
                                  (ngModelChange)="filter($event)"
                                  class="p-inputtext"
                                  placeholder="Search">
                            </ng-template>
                        </p-columnFilter>

                    <p-columnFilter *ngIf="col.ShowFilter && col.filterWidget == 'normal' && col.filterType == 'date'"
                        type="{{col.filterType}}" field="{{col.ColumnName}}" [showMatchModes]="false" [showOperator]="false"
                        [showAddButton]="false" display="menu"></p-columnFilter>
                    <p-sortIcon *ngIf="col.sort" field="{{col.ColumnName}}"></p-sortIcon>
                </th>
            </tr>
        </ng-template>
        <ng-template pTemplate="body" let-rowData let-data let-columns="columns">
            <tr [pSelectableRow]="rowData" [pSelectableRowDisabled]="selectionMode != 'single'">
                <td style="flex: 0.09 1 0;" *ngIf="checkBoxShow" class="checkboxth">
                    <p-tableCheckbox [value]="rowData" (click)="selectRow()"></p-tableCheckbox>
                </td>
                <td *ngFor="let col of columns" [hidden]="!col.ShowGrid">
                    <span *ngIf="!col.multi && col.ColumnName!='action'">
                        <span *ngIf="screenTable !='environment_table'">
                            <span *ngIf="col.ColumnName != 'priority' && col.ColumnName != 'department' && col.ColumnName != 'amount' && col.ColumnName!='connectionLogo' && col.ColumnName!='actionLogo'">
                                <span *ngIf="screenTable == 'recentActivityList' && col.ColumnName == 'lastModifiedUsername' " class="prjlastupdateprofile">{{rowData['lastModifiedByEmail']|userLetters:users_list}}</span>
                                <span> {{col.filterType=='date' ?(screenTable=='taskList'?(rowData[col.ColumnName]|date:'MMM d, y'):(rowData[col.ColumnName]|date:'MMM d, y H:mm')):(rowData[col.ColumnName]?rowData[col.ColumnName]:'-' )}} </span>
                            </span>
                            <span *ngIf="col.ColumnName == 'department'" [pTooltip]="rowData[col.ColumnName]" tooltipPosition="top"> {{rowData[col.ColumnName]}} </span>
                            <span *ngIf="col.ColumnName == 'priority'" [ngStyle]="{'color':getColor(rowData[col.ColumnName])}">{{rowData[col.ColumnName]}} Priority</span>
                            <span *ngIf="col.ColumnName == 'amount'">${{rowData[col.ColumnName]}}</span>
                            <span *ngIf="col.ColumnName =='connectionLogo'"><img [src]="'data:image/png;base64,'+rowData['connectionLogo']" style="height:25px;" alt="img"></span>
                            <span *ngIf="col.ColumnName == 'actionLogo'"><img [src]="'data:image/png;base64,'+rowData['actionLogo']" style="height:25px;" alt="img"></span>
                        </span>
                        <span *ngIf="screenTable =='environment_table'">
                            <span *ngIf="col.ColumnName == 'activeStatus_new'" >
                                <span *ngIf="rowData['activeStatus_new'] == 'Active'" class='green'>Active</span>
                                <span *ngIf="rowData['activeStatus_new'] == 'Inactive'" class='red'>Inactive</span>
                            </span>
                            <span *ngIf="col.ColumnName == 'deploy_status_new'">
                                <span *ngIf="rowData['deploy_status_new'] == 'Yes'"class='green'>Yes</span>
                                <span *ngIf="rowData['deploy_status_new'] == 'No'"class='red'>No</span>
                            </span>
                            <span *ngIf="col.ColumnName == 'createdTimeStamp_converted'">{{rowData[col.ColumnName]|date:'MMM d, y HH:mm'}}</span>
                            <span *ngIf="col.ColumnName != 'activeStatus_new' && col.ColumnName != 'deploy_status_new' && col.ColumnName != 'createdTimeStamp_converted'">
                                {{rowData[col.ColumnName]?rowData[col.ColumnName]:'-' }}
                            </span>
                        </span>
                    </span>
                    
                    <span *ngIf="col.multi && col.ColumnName!='action'">
                        <div *ngIf="col.multiOptions[1] == 'priority'">
                            <span class="prjtaskname">{{rowData[col.multiOptions[0]]}}</span>
                            <span class="prjgridpriority"  [ngStyle]="{'color':getColor(rowData[col.multiOptions[1]])}"> {{rowData[col.multiOptions[1]]}} Priority</span>
                        </div>
                        <div *ngIf="col.multiOptions[1] != 'priority'">
                            <div class="d-flex align-items-center">
                                <span class="prjlastupdateprofile">{{rowData['lastModifiedByEmail']|userLetters:users_list}}</span>
                                <span>
                                    <span class="prjlastupdatename">{{rowData[col.multiOptions[0]]}}</span>
                                    <span class="prjgridtimestamp" > {{rowData[col.multiOptions[1]]}} </span>
                                </span>
                            </div>
                        </div>
                    </span>
                    <!-- <span *ngIf="col.multi && col.ColumnName!='action'">{{rowData[col.multiOptions[0]]}} <br>
                        <span class="prjgridpriority" *ngIf="col.multiOptions[1] == 'priority'" [ngStyle]="{'color':getColor(rowData[col.multiOptions[1]])}"> {{rowData[col.multiOptions[1]]}} Priority</span>
                        <span class="prjgridtimestamp" *ngIf="col.multiOptions[1] != 'priority'"> {{rowData[col.multiOptions[1]]}} </span>
                    </span> -->
                    <!-- <span> {{rowData[col.multiOptions[1]]}} </span> -->
                    <!-- <span *ngIf="col.ColumnName!='action' && col.multi">
                        {{ rowData[col.ColumnName]?rowData[col.ColumnName]:'-' }}
                    </span> -->
                    <span *ngIf="col.ColumnName == 'action' && screenTable !='actionsTable'" class="newinntalx">
                        <a *ngIf="show_view_btn" class="" (click)="viewDetailsbyId(rowData)" pTooltip="View" tooltipPosition="top">
                            <img src="../../../assets/images/Projects/eye-show-blue.svg" alt="View" class="testplus default-img">
                        </a>
                        <span *ngIf='rowData[col.kafkaConFail] == "Y" && show_retry_btn' (click)="onRetryGraphGenerate(rowData)">
                            <img src="../../../../assets/images/PI/refresh.svg" alt="Refresh" class="testplus default-img" >
                            <img src="../../../../assets/images/PI/refresh-blue.svg" alt="Refresh" class="testplus hover-img" >
                        </span>
                        <span *ngIf="show_edit_btn" class="editButton">
                            <a *ngIf="!isdisabled_edit" (click)="editRowBy_Id(rowData)" pTooltip="Edit" tooltipPosition="top">
                                <img src="../../../assets/images/Projects/Edit-blue.svg" alt="Edit" class="testplus default-img">
                            </a>
                            <a *ngIf="isdisabled_edit">
                                <img src='../../../../assets/images/RPA/icon_latest/edit-dis.svg' alt="dis_edit" class="testplus">
                            </a>
                        </span>
                        <span *ngIf="show_delete_btn" class="editButton" >
                            <a *ngIf="!isdisabled_delete" (click)="deleteRow(rowData)" pTooltip="Delete" tooltipPosition="top">
                                <img src="../../../assets/images-n/common/delete-blue.svg" class="testplus default-img" alt="delete">
                            </a>
                            <a *ngIf="isdisabled_delete">
                                <img src='../../../../assets/images/RPA/icon_latest/delete-dis.svg' alt="dis_delete" class="testplus">
                            </a>
                        </span>
                        <span *ngIf="show_download_btn" class="editButton" >
                            <a  (click)="downloadRow(rowData)" pTooltip="Download" tooltipPosition="top">
                                <img src="../../../../assets/images-n/common/download-blue.svg" alt="download"
                                class="default-img testplus">
                            </a>
                        </span>
                    </span>
                    <span *ngIf="col.ColumnName == 'action' && screenTable=='users_screen'">
                        <div class="newinntalx">
                            <span *ngIf="loggedInUser==rowData['email']" class="editButton">
                                <a>
                                    <img src='../../../../assets/images/RPA/icon_latest/edit-dis.svg' alt="dis_edit" class="testplus">
                                </a>
                                <a>
                                    <img src='../../../../assets/images/RPA/icon_latest/delete-dis.svg' alt="dis_delete" class="testplus">
                                </a>
                            </span>
                            <span class="editButton" *ngIf="loggedInUser != rowData['email']" >
                                <a  (click)="editRowBy_Id(rowData)" pTooltip="Edit" tooltipPosition="top">
                                    <img src="../../../assets/images/Projects/Edit-blue.svg" alt="Edit" class="testplus default-img">
                                </a>
                                <a (click)="deleteRow(rowData)" pTooltip="Delete" tooltipPosition="top">
                                    <img src="../../../assets/images-n/common/delete-blue.svg" class="testplus default-img" alt="delete">
                                </a>
                                
                            </span>
                        </div>
                    </span>
                    <span *ngIf="col.ColumnName == 'action' && screenTable=='projectList' && selectedItem != null" class="w-100 text-center">
                        <div class="newinntalx actionicons" >
                            <!-- [hidden]="!(rowData.id == selectedItem.id)" -->
                            <a class="" (click)="viewDetailsbyId(rowData)" pTooltip="View" tooltipPosition="top">
                                <img src="../../../assets/images/Projects/eye-show-blue.svg" alt="View" class="testplus default-img">
                            </a>
                            <a (click)="deleteRow(rowData)" *ngIf="(!(this.userRoles.includes('System Admin')) && loggedInUser==rowData['owner'])
                            || (this.userRoles.includes('System Admin'))" pTooltip="Delete" tooltipPosition="top">
                                <img src="../../../assets/images-n/common/delete-blue.svg" alt="Delete" class="testplus default-img">
                        </a>
                        </div>
                    </span>
                    
                    <span *ngIf="col.ColumnName == 'action' && screenTable =='taskList' && selectedItem != null" class="taskList-table-actions">
                        <div class="newinntalx actionicons" >
                            <!-- [hidden]="!(rowData.id == selectedItem.id)" -->
                            <a *ngIf="rowData['taskCategory'] != 'Analysis'" class="" (click)="openWorkSpace(rowData)" pTooltip="Open Workspace" tooltipPosition="top">
                                <img src="./../../../../assets/images-n/projects/Open.svg" alt="Open">
                            </a>
                            <a class="" (click)="viewDetailsbyId(rowData)" pTooltip="View" tooltipPosition="top">
                                <img src="../../../assets/images/Projects/eye-show-blue.svg" alt="View" class="default-img">
                            </a>
                            <a (click)="deleteRow(rowData)" pTooltip="Delete" tooltipPosition="top">
                                <img src="../../../assets/images-n/common/delete-blue.svg" alt="Delete" class="default-img">
                            </a>
                        </div>
                    </span>
                    <span *ngIf="col.ColumnName == 'action' && screenTable =='actionsTable' && selectedItem != null" class="w-100 text-center">
                        <div class="newinntalx actionicons" >
                            <!-- [hidden]="!(rowData.id == selectedItem.id)" -->
                            <a class="" (click)="viewDetailsbyId(rowData)" *ngIf="(this.loggedUserRole.includes('Process Owner') || this.loggedUserRole.includes('RPA Developer'))" pTooltip="Edit" tooltipPosition="top">
                                <img src="../../../assets/images/Projects/Edit-blue.svg" alt="Edit" class="testplus default-img">
                            </a>
                            <a (click)="deleteRow(rowData)" *ngIf="(this.loggedUserRole.includes('Process Owner') || this.loggedUserRole.includes('RPA Developer'))" pTooltip="Delete" tooltipPosition="top">
                                <img src='../../../assets/images-n/common/delete-blue.svg' alt="edit"class="testplus default-img">
                            </a>
                        </div>
                    </span>

                    <span *ngIf="col.ColumnName == 'action' && screenTable =='connectionsList' && selectedItem != null" class="w-100 text-center">
                        <div class="newinntalx actionicons" >
                            <!-- [hidden]="!(rowData.id == selectedItem.id)" -->
                            <span class="" (click)="viewDetailsbyId(rowData)"  pTooltip="View" tooltipPosition="top">
                                <button>
                                    <img src="../../../../assets/images-n/projects/eye-show-blue.svg" alt="Edit" class="testplus default-img">
                                </button>
                            </span>
                            <span class="" (click)="openUpdateOverlayById(rowData)" *ngIf="(this.loggedUserRole.includes('Process Owner') || this.loggedUserRole.includes('RPA Developer'))" pTooltip="Edit" tooltipPosition="top">
                                <img src="../../../assets/images/Projects/Edit-blue.svg" alt="Edit" class="testplus default-img">
                            </span>
                            <span (click)="deleteRow(rowData)" *ngIf="(this.loggedUserRole.includes('Process Owner') || this.loggedUserRole.includes('RPA Developer'))" pTooltip="Delete" tooltipPosition="top">
                                <img src='../../../assets/images-n/common/delete-blue.svg' alt="edit"class="testplus default-img">
                            </span>
                        </div>
                    </span>
                </td>
            </tr>
        </ng-template>
        <ng-template pTemplate="emptymessage">
            <tr>
                <td style="justify-content: center;" colspan="7">No Records Found</td>
            </tr>
        </ng-template>
    </p-table>
</div>




